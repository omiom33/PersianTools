#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

# Distributed under the terms of MIT License (MIT)

# Based on fa.wikipedia's AbarAbzar tool
##https://fa.wikipedia.org/wiki/Mediawiki:Gadget-Extra-Editbuttons-persianwikitools.js
##https://fa.wikipedia.org/wiki/Mediawiki:Gadget-Extra-Editbuttons-persiantools.js
##https://fa.wikipedia.org/wiki/Mediawiki:Gadget-Extra-Editbuttons-dictionary.js

# This tool edits Persian texts and solve some of the wrong dictation, typo and ZWNJ problems
# It is not suitable for Mediawiki's syntax for editing in Mediawiki environment use fa_cosmetic_changes_core.py

import re

arabicDigits = ur'0123456789'
arabicIndicDigits = ur'٠١٢٣٤٥٦٧٨٩'

# نویسه\u200cهای غیرفارسی ي-ك-ە و موارد مشابه پیش از تبدیل به نویسهٔ فارسی در سایر ریجکس\u200cها باید به عنوان کاراکتر فارسی شناخته شوند.

similarPersianCharacters = ur'\u0643\uFB91\uFB90\uFB8F\uFB8E\uFEDC\uFEDB\uFEDA\uFED9\u0649\uFEEF\u064A\u06C1\u06D5\u06BE\uFEF0-\uFEF4'
vowels = ur'\u064B-\u0650\u0652\u0670'
persianCharacters = ur'\u0621-\u0655\u067E\u0686\u0698\u06AF\u06A9\u0643\u06AA\uFED9\uFEDA\u06CC\uFEF1\uFEF2' + similarPersianCharacters
persianCharactersNoVowels = ur'\u0621-\u064A\u0653-\u0655\u067E\u0686\u0698\u06AF\u06A9\u0643\u06AA\uFED9\uFEDA\u06CC\uFEF1\uFEF2' + similarPersianCharacters
persianDigits = ur'۰۱۲۳۴۵۶۷۸۹'
hamza = ur'\u0654'
NASB = u'\u064b'
ZAMM = u'\u064c'
persianPastVerbs = ur'(' \
                   + ur'ارزید|افتاد|افراشت|افروخت|افزود|افسرد|افشاند|افکند|انباشت|انجامید|انداخت|اندوخت|اندود|اندیشید|انگاشت|انگیخت|انگیزاند|اوباشت|ایستاد' \
                   + ur'|آراست|آراماند|آرامید|آرمید|آزرد|آزمود|آسود|آشامید|آشفت|آشوبید|آغازید|آغشت|آفرید|آکند|آگند|آلود|آمد|آمرزید|آموخت|آموزاند' \
                   + ur'|آمیخت|آهیخت|آورد|آویخت|باخت|باراند|بارید|بافت|بالید|باوراند|بایست|بخشود|بخشید|برازید|برد|برید|بست|بسود|بسیجید|بلعید' \
                   + ur'|بود|بوسید|بویید|بیخت|پاشاند|پاشید|پالود|پایید|پخت|پذیراند|پذیرفت|پراکند|پراند|پرداخت|پرستید|پرسید|پرهیزید|پروراند|پرورد|پرید' \
                   + ur'|پژمرد|پژوهید|پسندید|پلاسید|پلکید|پناهید|پنداشت|پوسید|پوشاند|پوشید|پویید|پیچاند|پیچانید|پیچید|پیراست|پیمود|پیوست|تاباند|تابید|تاخت' \
                   + ur'|تاراند|تازاند|تازید|تافت|تپاند|تپید|تراشاند|تراشید|تراوید|ترساند|ترسید|ترشید|ترکاند|ترکید|تکاند|تکانید|تنید|توانست|جَست|جُست' \
                   + ur'|جست|جنباند|جنبید|جنگید|جهاند|جهید|جوشاند|جوشید|جوید|چاپید|چایید|چپاند|چپید|چراند|چربید|چرخاند|چرخید|چرید|چسباند|چسبید' \
                   + ur'|چشاند|چشید|چکاند|چکید|چلاند|چلانید|چمید|چید|خاراند|خارید|خاست|خایید|خراشاند|خراشید|خرامید|خروشید|خرید|خزید|خست|خشکاند' \
                   + ur'|خشکید|خفت|خلید|خمید|خنداند|خندانید|خندید|خواباند|خوابانید|خوابید|خواست|خواند|خوراند|خورد|خوفید|خیساند|خیسید|داد|داشت|دانست' \
                   + ur'|درخشانید|درخشید|دروید|درید|دزدید|دمید|دواند|دوخت|دوشید|دوید|دید|دیدم|راند|ربود|رخشید|رساند|رسانید|رست|رَست|رُست' \
                   + ur'|رسید|رشت|رفت|رُفت|رقصاند|رقصید|رمید|رنجاند|رنجید|رندید|رهاند|رهانید|رهید|روبید|روفت|رویاند|رویید|ریخت|رید|ریسید' \
                   + ur'|زاد|زارید|زایید|زد|زدود|زیست|سابید|ساخت|سپارد|سپرد|سپوخت|ستاند|ستد|سترد|ستود|ستیزید|سرایید|سرشت|سرود|سرید' \
                   + ur'|سزید|سفت|سگالید|سنجید|سوخت|سود|سوزاند|شاشید|شایست|شتافت|شد|شست|شکافت|شکست|شکفت|شکیفت|شگفت|شمارد|شمرد|شناخت' \
                   + ur'|شناساند|شنید|شوراند|شورید|طپید|طلبید|طوفید|غارتید|غرید|غلتاند|غلتانید|غلتید|غلطاند|غلطانید|غلطید|غنود|فرستاد|فرسود|فرمود|فروخت' \
                   + ur'|فریفت|فشاند|فشرد|فهماند|فهمید|قاپید|قبولاند|کاست|کاشت|کاوید|کرد|کشاند|کشانید|کشت|کشید|کفت|کفید|کند|کوبید|کوچید' \
                   + ur'|کوشید|کوفت|گَزید|گُزید|گایید|گداخت|گذارد|گذاشت|گذراند|گذشت|گرازید|گرایید|گرداند|گردانید|گردید|گرفت|گروید|گریاند|گریخت|گریست' \
                   + ur'|گزارد|گزید|گسارد|گستراند|گسترد|گسست|گسیخت|گشت|گشود|گفت|گمارد|گماشت|گنجاند|گنجانید|گنجید|گندید|گوارید|گوزید|لرزاند|لرزید' \
                   + ur'|لغزاند|لغزید|لمباند|لمدنی|لمید|لندید|لنگید|لهید|لولید|لیسید|ماسید|مالاند|مالید|ماند|مانست|مرد|مکشید|مکید|مولید|مویید' \
                   + ur'|نازید|نالید|نامید|نشاند|نشست|نکوهید|نگاشت|نگریست|نمایاند|نمود|نهاد|نهفت|نواخت|نوردید|نوشاند|نوشت|نوشید|نیوشید|هراسید|هشت' \
                   + ur'|ورزید|وزاند|وزید|یارست|یازید|یافت' + ur')'

persianPresentVerbs = ur'(' \
                      + ur'ارز|افت|افراز|افروز|افزا|افزای|افسر|افشان|افکن|انبار|انباز|انجام|انداز|اندای|اندوز|اندیش|انگار|انگیز|انگیزان' \
                      + ur'|اوبار|ایست|آرا|آرام|آرامان|آرای|آزار|آزما|آزمای|آسا|آسای|آشام|آشوب|آغار|آغاز|آفرین|آکن|آگن|آلا|آلای' \
                      + ur'|آمرز|آموز|آموزان|آمیز|آهنج|آور|آویز|آی|بار|باران|باز|باش|باف|بال|باوران|بای|باید|بخش|بخشا|بخشای' \
                      + ur'|بر|بَر|بُر|براز|بساو|بسیج|بلع|بند|بو|بوس|بوی|بیز|بین|پا|پاش|پاشان|پالا|پالای|پذیر|پذیران' \
                      + ur'|پر|پراکن|پران|پرداز|پرس|پرست|پرهیز|پرور|پروران|پز|پژمر|پژوه|پسند|پلاس|پلک|پناه|پندار|پوس|پوش|پوشان' \
                      + ur'|پوی|پیچ|پیچان|پیرا|پیرای|پیما|پیمای|پیوند|تاب|تابان|تاران|تاز|تازان|تپ|تپان|تراش|تراشان|تراو|ترس|ترسان' \
                      + ur'|ترش|ترک|ترکان|تکان|تن|توان|توپ|جنب|جنبان|جنگ|جه|جهان|جو|جوش|جوشان|جوی|چاپ|چای|چپ|چپان' \
                      + ur'|چر|چران|چرب|چرخ|چرخان|چسب|چسبان|چش|چشان|چک|چکان|چل|چلان|چم|چین|خار|خاران|خای|خر|خراش' \
                      + ur'|خراشان|خرام|خروش|خز|خست|خشک|خشکان|خل|خم|خند|خندان|خواب|خوابان|خوان|خواه|خور|خوران|خوف|خیز|خیس' \
                      + ur'|خیسان|دار|درخش|درخشان|درو|دزد|دم|ده|دو|دوان|دوز|دوش|ران|ربا|ربای|رخش|رس|رسان' \
                      + ur'|رشت|رقص|رقصان|رم|رنج|رنجان|رند|ره|رهان|رو|روب|روی|رویان|ریز|ریس|رین|زا|زار|زای|زدا' \
                      + ur'|زدای|زن|زی|ساب|ساز|سای|سپار|سپر|سپوز|ستا|ستان|ستر|ستیز|سر|سرا|سرای|سرشت|سز|سگال|سنب' \
                      + ur'|سنج|سوز|سوزان|شاش|شای|شتاب|شکاف|شکف|شکن|شکوف|شکیب|شمار|شمر|شناس|شناسان|شنو|شو|شور|شوران|شوی' \
                      + ur'|طپ|طلب|طوف|غارت|غر|غلت|غلتان|غلط|غلطان|غنو|فرسا|فرسای|فرست|فرما|فرمای|فروش|فریب|فشار|فشان|فشر' \
                      + ur'|فهم|فهمان|قاپ|قبولان|کار|کاه|کاو|کش|کَش|کُش|کِش|کشان|کف|کن|کوب|کوچ|کوش|گا|گای|گداز' \
                      + ur'|گذار|گذر|گذران|گرا|گراز|گرای|گرد|گردان|گرو|گری|گریان|گریز|گز|گزار|گزین|گسار|گستر|گستران|گسل|گشا' \
                      + ur'|گشای|گمار|گنج|گنجان|گند|گو|گوار|گوز|گوی|گیر|لرز|لرزان|لغز|لغزان|لم|لمبان|لند|لنگ|له|لول' \
                      + ur'|لیس|ماس|مال|مان|مک|مول|موی|میر|ناز|نال|نام|نشان|نشین|نکوه|نگار|نگر|نما|نمای|نمایان|نه' \
                      + ur'|نهنب|نواز|نورد|نوش|نوشان|نویس|نیوش|هراس|هست|هل|ورز|وز|وزان|یاب|یار|یاز' \
                      + ur')'

persianComplexPastVerbs = {  # bug: در گذشته
    ur'باز': u'آفرید|آمد|آموخت|آورد|ایستاد|تابید|جست|خواند|داشت|رساند|ستاند|شمرد|ماند|نمایاند|نهاد|نگریست|پرسید|گذارد' \
            + ur'|گرداند|گردید|گرفت|گشت|گشود|گفت|یافت',
    ur'در': u'بر ?داشت|بر ?گرفت|آمد|آمیخت|آورد|آویخت|افتاد|افکند|انداخت|رفت|ماند|نوردید|کشید|گرفت',
    ur'بر': u'آشفت|آمد|آورد|افتاد|افراشت|افروخت|افشاند|افکند|انداخت|انگیخت|تاباند|تابید|تافت|تنید|جهید|خاست|خواست|خورد' \
           + ur'|داشت|دمید|شمرد|نهاد|چید|کرد|کشید|گرداند|گردانید|گردید|گزید|گشت|گشود|گمارد|گماشت',
    ur'فرو': u'آمد|خورد|داد|رفت|نشاند|کرد|گذارد|گذاشت',
    ur'وا': u'داشت|رهاند|ماند|نهاد|کرد',
    ur'ور': u'آمد|افتاد|رفت',
    ur'یاد': u'گرفت',
    ur'پدید': u'آورد',
    ur'پراکنده': u'ساخت',
    ur'زمین': u'خورد',
    ur'گول': u'زد',
    ur'لخت': u'کرد',
}

persianComplexPresentVerbs = {  # مشکل با: در روم باستان، در ده
    # مشکل با : بر گردن
    ur'باز': u'آفرین|آموز|آور|ایست|تاب|جو|خوان|دار|رس|ستان|شمار|مان|نمایان|نه|نگر|پرس|گذار|گردان|گرد|گشا|گو|گیر|یاب',
    ur'در': u'بر ?دار|بر ?گیر|آمیز|آور|آویز|افت|افکن|انداز|مان|نورد|کش|گذر|گیر',
    ur'بر': u'آشوب|آور|افت|افراز|افروز|افشان|افکن|انداز|انگیز|تابان|تاب|تن|جه|خواه|خور|خیز|دار|دم|شمار|نه|چین|کش|کن' \
           + ur'|گردان|گزین|گشا|گمار',
    ur'فرو': u'خور|ده|رو|نشین|کن|گذار',
    ur'وا': u'دار|رهان|مان|نه|کن',
    ur'ور': u'افت|رو',
    ur'یاد': u'گیر',
    ur'پدید': u'آور',
    ur'پراکنده': u'ساز',
    ur'زمین': u'خور',
    ur'گول': u'زن',
    ur'لخت': u'کن',
}

adjective = \
    ur'اخمو|ارزان|ارغه|الکن|الکی|انبوه|آبدار|(نا)?آرام|آرغنده|(نا)?آشکار|(نا)?آماده|آهسته|(بی\u200c|با)انضباط|باریک|بد|بدحساب|بددل|بدریخت' \
    + ur'|بر|براق|برخوردار|برومند|بزدل|بلند|بی‌آلایش|بی دست و پا|بیچاره|بیدار|بیمار|پخ|پخش|پخمه|پرت|پرنور|پست|پشمالو|پلید|پوچ|(سر|نا)?پوشیده|پوک' \
    + ur'|پیر|پیروز|تار|تپل|ترد|ترسو|تفت|تلخ|تنبل|تندرو|تنک|تنگ|تنها|تهی|تیره|جلو|چابک|چاپلوس|چالاک|چپ|چرند|چسبان|چفته|چیره|خام|خانم|خراب' \
    + ur'|خرم|خسته|خشک|(نا)?خفته|خفن|خل|خنگ|(نا)?خوانا|خوب|خوشکل|خوش‌گوار|خیراندیش|دراز|درخور|درستکار|دلباخته|دلیر|دوست|دون|رحیم|رسمی|روانی|روشن' \
    + ur'|ریغو|زبر|زبردست|زبل|زشت|زیبا|زیرک|ژرف|ژنده|ساده|(نا)?سالم|ساکت|سبک|سخاوتمند|سر|سرکش|سفت|سوسول|شایسته|شکیبا|شل|شور|طولانی|عالم|فراوان|فرز' \
    + ur'|فنی|قرتی|قشنگ|قلنبه|قهرمان|کارکن|کال|کبود|کج|کچل|کر|کلان|کلفت|کم|کند|کنس|کوتاه|کوتوله|کوچک|کوچولو|کودن|گدا|گران|گرسنه|گشاد' \
    + ur'|گنگ|گود|گیج|لاغر|لبریز|لخت|لغزنده|له|مات|مچاله|مچل|(نا)?مرد|مردمی|مردنی|مست|مشکوک|مفید|ناپدید|ناپسند|ناتوان|ناجنس|ناجور|ناچیز|ناخوش' \
    + ur'|نادان|(نا)?درست|نازک|ناسپاس|نافرمان|ناگوار|نامرد|نرم|نیازمند|نیرومند|هشیار|هیز|واژگون|ول|ولرم|ولنگار|یکپارچه|یکدست|یکرنگ|(نا)?پیدا' \
    + ur'|گناهکار|ریز|دانا|کثیف|آقا|(با|بی\u200c)سواد|عاشق|(با|بی\u200c)محبت|صاف|زمخت|فریبنده|پیچیده|سخت|دشوار|تمیز|(نا)?پاکیزه|بزرگ|پهن|پخته|بی‌مورد' \
    + ur'|بی‌نیاز|(بی\u200c|با|)تجربه'

personNames = \
    ur'الله|محمد|علی|حسن|حسین|جواد|باقر|مهدی|تقی|نقی|نازی|نجم|' \
    + ur'اکرم|کاظم|عباس|منصور|خسرو|محمود|شمس|ملک|شوکت|' \
    + ur'نصر|همت|جهان|جلال|موسی|ابراهیم|جعفر|احمد|قاسم|کمال|هاشم|' \
    + ur'شفیع|صمد|شیخ|اسماعیل|ربیع|سلیمان|رستم|شاهرخ|فرخ|شریف|نعمت|' \
    + ur'امیر|خلیل|جلیل|مجید|اسد|شوکت|رضا|عجل|ید|عبد|سهیل|معصوم|عظیم' \
    + ur'اکبر|اصغر|بهمن|قلی'

wordsWithA = \
    ur'ورامدن|هرزاب|هراینه|هجوامیز|نوش‌اذر|نواوری|نواموز|نهراب|میراخور|میراب|می‌اید|می‌اورند|مرات' \
    + ur'|ماخذ|مابی|لس‌انجلس|گل‌اذین|گزنداور|گرداوری|گرداوردن|گرداورد|گردامدن|کنداور|کفرامیز|فرودامدن|عطراگین|طنزامیز' \
    + ur'|شیرابه|شهرا[یئ]ین|شهراشوب|سوداور|سراوردن|سرامدن|سرامد|سراشپز|سحرامیز|زیرابی|زوراور|زهرالود|زهراگین|زردالو|دوداهنگ|دواتشه' \
    + ur'|دژاهنگ|دژالود|درداور|دردالود|درایند|دراید|دراویختن|دراوری|دراورنده|دراورند|دراوردن|درامده|درامدن|درامد|خیزاب|خشم‌الود' \
    + ur'|چندش‌اور|جگراور|تیراهن|تهورامیز|تنفراور|تنداب|پسندامدن|پرنداور|پردرامد|پراشوب|پراب|بی‌اب|بوا|بنداوردن' \
    + ur'|بنداور|سرامدن|برایند|براورده|براوردن|براورد|برامده|برامدن|برامدگی|برامد|براشفته|براشفتن|براشفتگی|براسودن|بداهنگ' \
    + ur'|بداموزی|بدامدن|بدامد|ائورت|ائسه|ا[یئ]ینه|ا[یئ]ین‌نامه|ا[یئ]ین|ایه‌یاب|ایه|اینه‌دار|اینده|ایندگان|ایفون' \
    + ur'|ایروپلن|ایدین|ایتم|ایت‌الله|ایت|ایات|اویشن|اویسا|اویژه|اویزون|اویزه|اویزند|اویزگر|اویزش' \
    + ur'|اویزدار|اویزان|اویز|اویخته|اویختنی|اویختن|اویختگی|اویخت|اویتخه|اووکادو|اونگون|اونگان|اونگ|اوند|اوریل' \
    + ur'|اوریدن|اورنده|اورند|اورنجن|اوردیدن|اورده|اوردنی|اوردن|اوردگه|اوردگاه|اوردجو|اورد' \
    + ur'|اوایش|اوانویس|اوانگارد|اوانتاژ|اواکس|اواشناس|اوازه‌خوان|اوازهای|اوازه|اوازخوان|اواز|اواره|اوارگی|اوارگان' \
    + ur'|اوار|اهو|اهنین|اهنگ‌ساز|اهنگرخانه|اهنگر|اهنگ|اهن‌فروش|اهن‌ربا' \
    + ur'|اهن‌پاره|اهن‌بر|اهن‌الات|اهن|اهک‌سازی|اهک‌پزی|اهک‌پز|اهک|اهسته|اهستگی|اهای|اهان' \
    + ur'|انیون|انوقت|انود|انها|ان‌گه|ان‌گاه|ان‌که|ان‌کس|انکارا|ان‌قدر|انفولانزا|انفلوانزا' \
    + ur'|انفارکتوس|ان‌طور|ان‌طرف|ان‌سو|انژیوگرافی|انژین|انزیم|ان‌روی|ان‌روز|ان‌رو|اندوسکوپی|ان‌چه|ان‌جا|انتیل|انتیک' \
    + ur'|انتی|انتن|انتریک|انتراکت|انتراسیت|انتالیا|اناهیتا|اناناس|انان|انالیز|انالوگ|انارشیسم|اناتومی|اناتولی' \
    + ur'|انابولیسم|امینه|امیغه|امیغ|امیزه|امیزگار|امیزش|امیز|امیخته|امیختن|امیختگی|امیب|امونیوم|امونیت|امونیاک|امون' \
    + ur'|اموکسی|اموزه|اموزنده|اموزگان|اموزگار|اموزش‌یار|اموزشگاه|اموزشکده|اموزش|اموزانه|اموزاندن|اموز|اموده|امودن|امودریا' \
    + ur'|اموخته|اموختن|اموختگی|اموختار|امله|امریکا|امرزیده|امرزیدن|امرزیدگی|امرزنده|امرزگار|امرزش|امرز|امرانه' \
    + ur'|امدید|امدوشد|امدورفت|امده|امدن|امدگی|امدکردن|امد|امخته|امپلی|امپرسنج|امپر|امبولی|امبولانس|امایه|امایش|امال' \
    + ur'|اماسیده|اماسیدن|اماسانیدن|اماس|امازون|امارگیر|امارگر|امارشناسی|امارشناس|اماده‌کردن|اماده|امادگی|امادگاه' \
    + ur'|اماج‌گاه|اماج|اماتور|الیداد|الیاژهای|الیاژ|الونک|الومینیوم|الومینیم|الوزرد|الوده|الودن|الودگی|الودگر|الود|الوچه' \
    + ur'|الوبخارا|الما|الفرد|الفا|الرژی|التو|الترناتیو|الت|الپ|البومین|البوم|البانی|البالوئی|البالو|الا[یئ]یدن' \
    + ur'|الایشی|الایش|الای|الاسکا|الاخون|الاچیق|الات|الاباما|اگنه|اگنده|اگندن|اگاهی‌نامه|اگاهی‌دادن|اگاهی|اگاهگان' \
    + ur'|اگاهانیدن|اگاهانه|اگاهاندن|اگاه|اکوستیک|اکوردئون|اکواریوم|اکنه|اکنش|اکنده|اکندن|اکله|اکسفورد|اکروبات|اکتئون' \
    + ur'|اکتینیوم|اکانتاسه|اکادمیک|اکادمی|اق‌بانو|اقائی|اقایان|اقامنشانه|اقامنش|اقاسی|اقازاده|اقاجان|اقا' \
    + ur'|افریننده|افرینش|افرین|افریکانس|افریقا|افریده|افریدن|افریدگار|افتومات|افتابه|افتاب‌مهتاب|افتاب‌گیر' \
    + ur'|افتاب‌گردان|افتاب‌زده|افتاب‌زدگی|افتاب‌رو|افتاب‌خورده|افتاب‌پرست|افتاب|افاقی|افاق|افات|اغول|اغوشیدن|اغوش|اغل' \
    + ur'|اغشته|اغشتن|اغشتگی|اغش|اغالش|اغاسی|اغازین|اغازیدن|اغازیان|اغازی|اغازه|اغازگر|اغاز|اغاجی|اغا|اشیل|اشیانی|اشیانه' \
    + ur'|اشیان‌بندی|اشیان|اشور|اشوبیدن|اشوب‌ناک|اشوب‌گرانه|اشوب‌گر|اشوب‌کن|اشوب‌طلب|اشوب‌انگیز|اشوب|اشنایان|اشناوری' \
    + ur'|اشناگر|اشناسازی|اشنا|اشکوخیدن|اشکاره|اشکارگر|اشکارساز|اشکارا|اشکار|اشفته|اشفتن|اشفتگی|اشغالدان|اشتی' \
    + ur'|اشفتگی|اشپزخانه|اشپز|اشامیدنی|اشامیدن|اشامه|اشامنده|اشام|اشاب|اسیمه|اسیمگی|اسیب‌زدن' \
    + ur'|اسیب‌دیده|اسیب|اسیاکردن|اسیاسنگ|اسیازنه|اسیاچرخ|اسیابان|اسیاب|اسیا|اسوده‌خاطر|اسوده‌حال|اسوده|اسودن' \
    + ur'|اسودگی|اسمون|اسمانه|اسمان‌سنجی|اسمان‌خراش|اسمانخانه|اسمان|اسکاریس|اسفالت|استینه|استرکاری' \
    + ur'|استردوز|استانه|اسپیرین|اسپرین|اسائی|اسا[یئ]یدن|اساینده|اسایشگاه|اسایش|اسان‌گیری|اسانسورچی' \
    + ur'|اسانسور|اسان|اژیرهوائی|اژیر|اژیانه|اژنگ|اژند|اژفنداک|اژدار|اژانس|ازیدن|ازیتا|ازوقه|ازمون‌گر|ازمون‌گاه|ازمون|ازموده' \
    + ur'|ازمودن|ازمودگی|ازمندی|ازمند|ازمائی|ازمایه|ازماینده|ازمایشی|ازمایشو|ازمایشگاه|ازمایشات|ازمایش|ازمابنده|ازما|ازگار' \
    + ur'|ازرده|ازردن|ازردگی|ازرد|ازاریدن|ازارنده|ازاررسان|ازاردهنده|ازار|ازادی‌خواه|ازادوار' \
    + ur'|ازاده|ازادمنش|ازادمرد|ازادگی|ازادگان|ازادکامی|ازادانه|ازاد|اریانا|اریان|اریا|ار[و]غ' \
    + ur'|ارواره|ارنولد|ارنگ|ارنج|ارنائوت|ارمینا|ارمین|ارمیس|ارمیده|ارمیدن|ارمیدگی|ارمیچر|ارمه|ارمان‌شهر|ارماگدون|ارگون' \
    + ur'|ارکاد|ارشیو|ارشیتکت|ارشه|ارشام|ارش|ارستن|ارسان|ارژانتین|ارزومندانه|ارزومند|ارزوخواه|ارزو|ارتین|ارتیشو|ارتیست' \
    + ur'|ارتور|ارتمیس|ارتروز|ارا[یئ]یدن|ارایه‌گر|ارایشی|ارایشگر|ارایشگاه|ارایش|ارامیدن|ارامگاه|ارامگان|ارام‌کردن' \
    + ur'|ارامش|ارامانیدن|ارام|اراسته|اراستن|اراستگی|ارارات|اراء|اذین|اذرین|اذرنوش|اذرنگ|اذرگون|اذرشهر|اذرسنجی' \
    + ur'|اذرروز|اذرخش|اذربرزین|اذربایجان|اذر|ادینه|ادیس|ادونیس|ادنیس|ادمی‌گرا|ادمیزاد' \
    + ur'|ادمیرال|ادمیت|ادم‌گرا|ادم‌کش|ادمک|ادم‌فروش|ادم‌ربا|ادم‌خوار|ادرنالین|ادرس|ادامس|اداب|اخوندک|اخوند' \
    + ur'|اخور|اخرین|اخرسالار|اخرزمان|اخرت‌شناسی|اخرت|اخرالدواء|اخرالامر|اخر|اختن|احاد|اچمز|اچارکشی|اچاردار|اچار|اجیل|اجودان' \
    + ur'|اجرنما|اجرکاری|اجرچین|اجرپز|اجان|اثار|اتیه|اتیکا|اتیسا|اتلیه|اتشین|اتش‌ناک|اتش‌گیره|اتش‌گیر' \
    + ur'|اتش‌گون|اتش‌گرفتن|اتش‌گاه|اتشکده|اتش‌کار|اتش‌فشان|اتش‌زنه|اتش‌زدن|اتش‌زا|اتش‌دان|اتش‌خوار|اتش‌خانه|اتش‌پاره|اتش‌بان|اتش‌بازی|اتش‌بار' \
    + ur'|اتش|اتریوم|اتروپین|اتابای|اپولو|اپوستروف|اپاندیسیت|اپاندیس|اپارتمان|اپارتاید|اپارات|ابیار|ابونه|ابونمان' \
    + ur'|ابها|ابنوس|اب‌نمک|اب‌نما|اب‌[ن]شدنی|ابنبات|ابمیوه‌گیر|اب‌میوه|اب‌لیمو|ابله‌کوب|ابله‌رو|ابگینه|ابگیر|ابگونه|ابگون‌ساز' \
    + ur'|اب‌گوشت|اب‌گرمکن|اب‌گردان|اب‌گذر|اب‌گاه|اب‌کش|اب‌کانه|اب‌کامه|اب‌کار|اب‌فشان|ابغوره|ابشی|ابشور|اب‌شنگولی|ابشش|اب‌شدنی' \
    + ur'|ابش‌خور|ابشتگاه|ابشار|ابسوار|ابسه|ابسکون|ابستن|ابسالان|اب‌سال|ابزی‌گاه|ابزی‌دان|ابزی|ابریزگاه|ابریزگان|ابریزش' \
    + ur'|ابریز|ابرومند|ابروریزی|ابرنگ|ابرفت|ابراهه|ابراهک|ابراه|ابدیده|ابدزدک|ابدانک|ابدان|ابداری|ابدارخانه|ابدارچی' \
    + ur'|ابدارباشی|ابدار|اب‌خیز|ابخوری|ابجی|ابجوفروشی|ابجوساز|ابجوساختن|ابجو|ابتین|ابتنی|اب‌پنیر|اگهی' \
    + ur'|اب‌پاش|اب‌بها|اب‌بند|اب‌باز|اب‌انبار|ابان|اباژور|اباده|ابادکردن|ابادسازی|ابادان|اباد|اباء'  # first charcter should be آ

# removed ان for [[ان بی سی]]
# match ZWNJ also as a space or optional

wordsWithA = wordsWithA.replace(ur"\u200c", u'[\u200c ]?')

PresentVerbsWithA = \
    ur'ارا|ارام|ارامان|ارای|ازار|ازما|ازمای|اسا|اسای|اشام|اشوب|اغار|اغاز|افرین|اکن|اگن|الای' \
    + ur'|امرز|اموز|اموزان|امیز|اهنج|اور|اویز'

PastVerbsWithA = \
    ur'اراماند|ارامید|ارمید|ازرد|ازمود|اشامید|اشفت|اشوبید|اغازید|اغشت|افرید|اکند|اگند|الود' \
    + ur'|امد|امرزید|اموخت|اموزاند|امیخت|اهیخت|اورد|اویخت'

needsNasb = \
    ur'اتفاقا|الزاما|لزوما|یقینا|قطعا|حتما|قاعدتا|طبیعتا|طبعا|قهرا|جدّا|حقیقتا|واقعا|مطمئنا|واضحا|مسلما|تماما|کاملا' \
    + ur'|عینا|اکیدا|مطلقا|دقیقا|مستقیما|اصولا|اصلا|اصالتا|نسبا|نسبتا|تقریبا|حدودا|معمولا|قانونا|شرعا|اخلاقا|خلقا|احتمالا' \
    + ur'|استثنائا|اساسا|کلّ?ا|جزئا|مجموعا|جمعا|اجماعا|شدیدا|نهایتا|اقلا|اکثرا|غالبا|عمدتا|ندرتا|بعضا|گاها|صریحا|صراحتا|عموما' \
    + ur'|اختصاصا|خصوصا|مجملا|اجمالا|اختصارا|مختصرا|مشروحا|ظاهرا|باطنا|عمیقا|ذاتا|فطرتا|جسما|ابتدائا|مقدمتا|بدوا|بعدا|قبلا' \
    + ur'|جدیدا|سابقا|اخیرا|ابدا|عمرا|تلویحا|علنا|حضورا|غیابا|نیابتا|لطفا|اجبارا|اختیارا|عالما|عمدا|عامدا|تعمدا|متعمدا|عادتا' \
    + ur'|مستقلا|احتیاطا|احیانا|غفلتا|سهوا|اشتباها|عاجلا|عجالتا|مرتجلا|ارتجالا|سریعا|فورا|دا[یئ]ما|ضرورتا|نقدا|منحصرا|صرفا|دفعتا' \
    + ur'|کرارا|مکررا|مجددا|مرتبا|مستمرا|متواترا|تدریجا|تصادفا|عملا|فعلا|موقتا|ضمنا|نتیجتا|نوعا|اصطلاحا|جسارتا|بالا ?غیرتا|م[وؤ]کدا' \
    + ur'|ذیلا|شخصا|مشترکا|مفصلا|رسما|ترجیحا|قلبا|ر[اأ]سا|تو[اأ]ما|متناوبا|متوالیا|متقابلا|متعاقبا|متّ?فقا|مثلا|فرضا|ایضا|مضافا' \
    + ur'|مصرّ?ا|ارفاقا|انصافا|جهارا|طولا|متدرجا|غانما|احتراما|ناچارا|سفارشا|تلفنا|زبانا|کتبا|شفاها|چهارما|ثانیا|ثالثا' \
    + ur'|رابعا|خامسا|سادسا|سابعا|ثامنا|تاسعا|عاشرا|مخصوصا'  # اولا و سوما می‌تواند یک نام خاص باشد.

HamzehZam = \
    ur'امیرالمومنین|مومن|رویا|فواد|موذن|مودب|موخر|مواخذه|مولف|موثر|مونث|موکد|موسس(?! خورناتسی)|سوال|موسسه'  # for[[ران مودی]]removedمودی
HamzehZam = HamzehZam.replace(ur'\u0648', ur'وء?')

HamzehNasb = \
    ur'تاکید|تالیف|تاسیس|تاسیسات|تامل|تفال|تاهل|تامین|تا[یئ]ید|تادیب|تاثیر|تاثر|تاثیرات|تاثیرگذار|تاجیل' \
    + ur'|تاخر|تاخیر|توام|ماوا|مستاجر|مبدا|منشا|متاسفانه|متاسف|متاثر|مساله|متاهل|خلا|ملا عام|رافت|ماخذ|مایوس|ماخوذ' \
    + ur'|مامور|مامورین|ماموران|ماموریت|مامون|مانوس'  # removed راس، تالم

HamzehAtEnd = \
    ur'اجزا|احشا|ارتجا|ارتقا|ازا|استثنا|استغنا|استقرا|استمنا|استهزا|اشبا|اشقیا|اشیا|اطبا|اطفا|اعتلا' \
    + ur'|اغوا|افترا|اقتضا|امنا|انبیا|انقضا|اولیا|ماورا'  # re املا-انشا-اعضا-امضا-انزوا-ابتلا-استعفا-اعلا-اعتنا بدون همزه متداولترند، ابدا می‌تواند با همزه یا نتوین باشد در نتیجه برداشته شد

HamzehAtInside = {ur'سو': u'استفاده|تعبیر|تفاهم|برداشت',
                  ur'ما': u'الشعیر', ur'ماورا': u'الطبیعه|النهر'}

AlefMaghsooreh = \
    ur'یحیا|حتا|خنثا|مبرا|مرتضا|مصطفا|موسا|مجتبا|عیسا|عظما|علارغم'  # removed اولا- الا

colorsNames = \
    ur'زرد|قرمز|آبی|سفید|سیاه|بنفش|سرخ|گلگون|ازرق|ابیض|نارنجی|توسی|کبود|ارغوانی|سورمه‌ای|سپید|مشکی|کرم|قهوه‌ای|سبز|طلا[یئ]ی'

persianNumbers = \
    ur'یک|دو|سه|چهار|پنج|شش|هفت|هشت|نه|ده|یازده|دوازده|سیزده|چهارده|' \
    + ur'پانزده|شانزده|هفده|هجده|نوزده|بیست|سی|چهل|پنجاه|شصت|هفتاد|هشتاد|نود|صد|هزار'

addToAbad = ur'گلون|افضل|رقی|خیر|دل|حاجی|سید|مبارک|گنج|نهنگ|چنگ|' \
            + ur'سرخ|جنگل|خرم|خونی|دولت|به|نیاز|حفظ|عیش|نجم|بلاش|شیار|' \
            + ur'فتح|فضل|خدر|ساق|کج|زین|اسلام|بالش|پارس|اسکل|یاخچی|مهندس|قوژد'

firstNameComplex = {
    ur'حمید|احمد|محمود': u'رضا',
    ur'خدا': ur'بنده|داد',
    ur'امیر': ur'علی|حسین|محمد|رضا|مهدی|عباس',
    ur'محمد': ur'حسین|رضا|مهدی|جواد|باقر|کاظم|حسن|علی|امیر|طاها|هادی|وحید|حمید',
    ur'علی': ur'رضا|محمد|اصغر|اکبر|قلی',
}

complexes = {  # اسم خاص
    # اسم مرکب
    # فعل
    # صفت مرکب
    # 'با': u'پرستیژ|ابهت|احساس|اخلاق|ادب|ارزش|استعداد|استقامت|اصالت|اقتدار|اهمیت|تدبیر|تربیت|تسلط|تعصب|تقوی',
    # 'باقی|ته': u'مانده', bug > باقی مانده بود- ته مانده بود.
    # طبق بندهای    شماره ..
    # 'طبق|زمان': u'بند',
    # 'مادر|خواهر|برادر|فرزند|پدر': u'خوانده', # bug > وی پدر خوانده شد.(پدر صدا زده شد)
    ur'ویکی': ur'پدیا|مدیا|انبار|واژه|نبشته|خبر|کتاب|داده|دیتا|سفر|تراول|دانشگاه',
    ur'ایده': ur'آل',
    ur'سخت|نرم|پای|جنگ|نوشت|بد|ماشین': ur'افزار',
    ur'جنگ': ur'افروز',
    ur'برون|درون|میان': ur'شهری',
    ur'میان': ur'وعده',
    ur'مشگین|کلان': ur'شهر',
    ur'پایه|برنامه': ur'ریزی',
    ur'پیاده': ur'روی|نظام',
    ur'انسان|روان|گیاه|زیست|جانور|نماد|زمین|هوا|ریخت|خدا|جامعه|رفتار|فرهنگ|معرفت|زبان|کتاب|ستاره|اختر|شرق|اسلام|ریشه|آسیب|باستان|حق|روش|مکان|ویروس': ur'شناس',
    ur'بهره|نتیجه|فاصله|اندازه|مچ|رونق|دست|پا|پاچه|آبمیوه|آتش|آمار|اوج|کشتی|رأی|رای|یار|تصمیم': ur'گیر',
    ur'بهره': ur'مند|کش|دهی',
    ur'ترانه': ur'سرا|سرایی|نویس|پرداز',
    ur'اوج': ur'دهی',
    ur'این': ur'گونه|جا|طور',
    ur'آزاد|بد|نیک|مثبت|مصلحت': ur'اندیش',
    ur'پناه|ستیزه': ur'جو|جویی|جویان',
    ur'هم': ur'اندیشی|ارزی|راهی|سانی|رزم|خانه|نشین|سان|بند|مرز|سایه|مسلک|زمان|معنی|گام',
    ur'گرم|نرم|سرد|جمع|خنک|خشک|مرطوب|ضرب|تقسیم|کم|سرگرم|خوشحال|ناراحت|سخت|روان|باز|زیبا|زشت|مصرف|تولید': ur'کننده|کنندگی|کنندگان',
    ur'خود|درون|پیه': ur'سوز',
    ur'دل': ur'افروز|آزار|آرا|آزرده|بریده|افسرده|ربا|سوز|خواه|گشا',
    ur'تفریق|افزایش|کاهش|ویرایش|کوزه|سفال|غارت|چپاول|صنعت|امداد|توطئه|حساب|افسون|ریخته|ترویج|جهاد|زر|درود|سفید|شیشه|حیله': ur'گر',
    ur'آهن': ur'ربا',
    ur'طیف|امکان|اقتصاد|نور|زمان|عمق|گرما|فشار|قطر': ur'سنج',
    ur'فیزیک|شیمی|ریاضی|تاریخ|قلم|کتاب': ur'دان',
    ur'نام|اسم|سیاهه|خود|فیلم‌نامه|فیلمنامه|کتاب|روان|نسخه|ویکی|پاک|چرک|دست|پشت|زیر|پا|داستان|برنامه|تاریخ|رمان|عریضه|قصه|مقاله': ur'نویس',
    ur'فیلم': ur'بردار|شناس',
    ur'بار|سرمایه|تخم|کتاب|خواب': ur'گذار',
    ur'شهر': ur'بانو|زاد|ناز|نوش',
    ur'اسد|اسماء?|اسم|امان|امر|امیر|امین|انصار|انعام|اهل|اولیاء?|اکرم|باب|بدیع|برات|بقیة|بهاء?|جار|جند|حبیب|حجت|حزب|حفظ|حمد|خلق|خلیل|خیر|ذبیح|ذکر|رام|رحمت|رحم|رسول|روح|سیف|شمس|شکر|صدق|صدیق|عبد|عزت|عزیز|عین|فتح|فرج|فضل|قدرت|لطف|لعنت|نصرت|نصر|نظیر|نعمت|نور|هیبت|ولی|کلام|کلیم|ید|یوم': ur'الله|اللهی',
    ur'مستند|هوا|روان|جریان|کار|مجسمه|ایمن|پیاده|مقاوم|امن|ساده|بهینه|مرتب|شبیه|ویکی|پل|جاده|راه|استاندارد|فیلم|آماده|رها|آگاه|زیبا|یکسان|ذخیره|استاندار|متمایز|جدا|شخصی|انبوه|خصوصی|رده|آشکار|ساعت|ماشین|زمینه|دست|سبب': ur'ساز',
    ur'احترام|اختلاف|اضطراب|اعجاب|افتخار|بحث|بر|تحسین|ترحم|تعجب|تعصب|تنفر|ت[اأ]ثر|ت[اأ]سف|ت[اأ]مل|جالب|جدل|جنجال|حزن|حیرت|خفت|خوف|خیال|چالش|دل|رعب|رقت|روح|شهوت|شور|شوق|شگفت|طرب|عبرت|غرور|غم|فرح|ملال|مهر|نشاط|نفرت|هراس|هوس|وحشت|ی[اأ]س': ur'برانگیز|انگیز',
    ur'چهره|دور|تاریخ|خبر|روزنامه|روز|لرزه': ur'نگار',
    ur'زود|آرام|آب|کله|آش|بخار': ur'پز',
    ur'مه|پیمان|یخ|سنگ|بت|صف|قانون|ساختار|هنجار': ur'شکن',
    ur'مه': ur'لقا',
    ur'خون': ur'آشام|خوار|بار|گرم|سرد|بها',
    ur'شیطان|خدا|بت|خورشید|مهر|آتش|یزدان|ایزد|گاو|خود|آفتاب|یکتا|پول|حق|مال|میهن|نژاد|وطن|یگانه': ur'پرست',
    ur'پا[یئ]ین|بالا|عقب|جلو|کنار|ساده|بزرگ|کوچک|عمیق|رقیق|ضخیم|فهیم|گسترده|مهم|مشکل|آسان': ur'تر',
    ur'برگشت|انحنا|برش|انعطاف|مهمان|امکان|تفکیک|تغییر|آسیب|تأثیر|دل|سازش|مهاجر|بازگشت': ur'پذیر|ناپذیر',
    ur'دانش': ur'آموخته|پژوه|آموختگی',
    ur'بی': ur'آلایش|ابهت|احترام|احساس|اختیار|اخلاق|ادب|اراده|ارزش|استعداد|استقامت|اصالت|اعتماد|اعتبار|اقتدار|امان|امنیت|انتها|اهمیت|بها|بو|تدبیر|تربیت|تسلط|تعصب|تقوی|توجه|ثبات|جنبه|حس|دریغ|دست و پا|دین|رنگ|روح|رویه|سابقه|سیم|شرف|شعور|لیاقت|مایه|مبالات|مزد|مزه|مصرف|معرفت|معنی|مقدار|مورد|نتیجه|نزاکت|نهایت|نیاز|وجدان|پایه|پرستیژ|پناه|پول|چاره|چیز|کار|دلیل|خبر|طرف|حجاب|هویت|آزار|گزند|حاشیه|تفاوت|حاصل|نام|فکر|بازگشت|شکل|کران|انگیزه|اندازه|ضرر|زیان|خرد|جوابنویس|ریا|باک|قاعده|حواس',
    ur'می': ur'دانم',
    ur'عرضه': ur'کننده|کنندگان',
    ur'ابرو': ur'کمان|قیطان',
    ur'ابله': ur'گونه',
    ur'ابن': ur'الیوم|الوقت|السبیل|عباس',
    ur'اغراق|خشونت': ur'آمیز',
    ur'اجاق': ur'کور|سوز',
    ur'اجل': ur'برگشته',
    ur'اسفل': ur'السافلین',
    ur'اطلاع': ur'رسان|رسانی|دهی',
    ur'انگشت': ur'نما|نشان|پیچ',
    ur'سپاس|نام': ur'گزار',
    ur'گوشت|گیاه|علف|شیر': ur'خوار',
    ur'آدم': ur'برفی|فروش|ربا|خوار',
    ur'آنتی': ur'بادی|ژن|ویروس|بیوتیک|اکسیدان',
    ur'تری|دی': ur'اکسید',
    ur'آب': ur'لمبو|تنی',
    ur'آب|چشمک': ur'بازی',
    ur'ریش|سنگ|قلم': ur'تراش',
    ur'آزرده': ur'جان',
    ur'آزادی|جمهوری|تمامیت|عدالت|وطن|بنفشه|خود|بد': ur'خواه',
    ur'آسوده': ur'خاطر|وجدان',
    ur'آش': ur'دهن|خور',
    ur'آشفته': ur'سامان|دماغ|روز',
    ur'آکنده': ur'گوش|پهلو',
    ur'آلاخون': ur'والاخون',
    ur'آمد': ur'نیامد|شد',
    #'با': ur'پرستیژ|ابهت|احساس|اخلاق|ادب|ارزش|استعداد|استقامت|اصالت|اقتدار|اهمیت|تدبیر|تربیت|تسلط|تعصب|تقوی',
    ur'باب': ur'الحوائج',
    #'باقی|ته': ur'مانده', bug > باقی مانده بود- ته مانده بود.
    ur'باد': ur'نشسته|گرفته',
    ur'بار': ur'خاطر',
    ur'بالا|پایین|پائین': ur'تنه',
    ur'برنامه|طرح|بتون': ur'ریز',
    ur'بزرگ': ur'سال|مرد',
    ur'بزن': ur'دررو|بهادر',
    ur'بد|خوش': ur'سیرت|اخلاق|تراش|ترکیب|ریخت|ادا|استیل|اندام|بو|بینانه|بینی|پخت|برخورد|یمن|خوراک|خیم|رکاب|حال|مزه|حساب|پوش|قلق|منظر|نام',
    ur'بد|خوش|آب|خواب|جهان': ur'نما',
    ur'بد': ur'انجام|پیله|خوی|عنق|کاره|گمان|گوهر|لگام|مسب|مست|مهر',
    ur'بن': ur'بست',
    ur'به': ur'شمار|سازی|غایت|کارگیری',
    ur'تماشا': ur'گر|چی|کننده',
    ur'حمله|بهره|پیشه|شعله|طاعت|طالع': ur'ور',
    ur'بین': ur'النهرین|الملل|الممالک',
    ur'پاچه': ur'ورمالیده',
    ur'تکه|پاره|آتش|آهن|جگر|چهار': ur'پاره',
    ur'جهان|خدا|سود|شفا|نیرو|گرما|سرما': ur'بخش',
    ur'پاک': ur'نفس|سرشت|دامن|سیرت|منش|دیده',
    ur'پالان': ur'سا[یئ]یده',
    ur'پینه|کفش|کلاه|تو|رو|چرخ|پالان': ur'دوز',
    ur'پراگنده|تاریک|شکسته|آشفته|آزرده|آسوده|بد|خوش|خونین|سیاه|نازک': ur'دل',
    ur'پری': ur'نژاد|چهر',
    ur'نیک|پست': ur'فطرت',
    ur'پی': ur'گم|گرد|فراخ|سپید|نوشت',
    ur'پیچ': ur'واپیچ|پیچ',
    ur'سفید|سیاه|قهوه‌ای|قرمز|زرد|سبز|بنفش|گلگون|سرخ|پیروزه|مشک|نیل|مشکین|رنگین': ur'فام|پوست',
    ur'پیش': ur'مرگ|کسوت|آمد|درآمد|آهنگ|شماره',
    ur'تازه': ur'وارد|خط|نفس',
    ur'سیمان|سفید|گل|چمن|مدد|رو|دست‌اندر|زیان|کهنه|کمک|تازه|پا|سنبل|شیرین|پنهان': ur'کار',
    ur'تام': ur'الاختیار',
    ur'خوش|زشت|ترش|میانه|پیاده': ur'رو',
    ur'ترگل': ur'ور گل',
    ur'تکه': ur'تکه',
    ur'ته': ur'استکان|لیوان|مانده|دیگ',
    ur'تن': ur'فروش|آسان|آرا|تن|پرور',
    ur'تند': ur'خو|خوی',
    ur'تنگ': ur'چشم',
    ur'تی': ur'تیش',
    ur'پا|تن|زیر|سبز|سرخ|قرمز': ur'پوش',
    ur'تیره': ur'روز',
    ur'جامع': ur'الشرایط|الاطراف',
    ur'جان': ur'سخت|جانی',
    ur'یدک|فرو|نسل|آدم|ویروس|نقشه|سر|آب|آچار|زوزه|تیغ|لوله|ماله|بار|خط|شیره': ur'کش',
    ur'کشتی|گرده|دشت|نگه|دید|زمین|جنگل|دروازه|ویکی|شتر|دیده': ur'بان',
    ur'چابک': ur'سوار|دست',
    ur'ناقاره|نقاره|چاپ|درشکه': ur'چی',
    ur'قاره|راه': ur'پیما|پیمایی|پیمایان',
    ur'چرب|آذری|ترک|فارسی': ur'زبان',
    ur'چشمه': ur'چشمه',
    ur'چل': ur'کلید|تاج|تکه',
    ur'ناقاره|چوبک|دف|دمبک|ساز|نی|سنتور|تار|ارگ': ur'زن',
    ur'چیره': ur'دست',
    ur'پول|فنگ|قالی|ظرف|خشک|لباس': ur'شو[ئی]ی',
    ur'چیز': ur'فهم',
    ur'حرف': ur'شنو',
    ur'حق': ur'السکوت|التدریس|الزحمه',
    ur'حکیم': ur'باشی',
    ur'حرام|حلال|نجیب|اشراف': ur'زاده|زادگان',
    ur'حیرت|دریا|دل': ur'زده',
    ur'حیرت|نام|مقام|یاد|خواب|درد|شگفت|جمع|الزام|چندش|خفقان': ur'آور',
    ur'خاله': ur'زنک',
    ur'خام': ur'طمع|طبع',
    ur'خرده': ur'پا|شیشه',
    ur'خشک|آسیمه': ur'سر',
    ur'خنده': ur'رو|خریش',
    ur'خواجه': ur'سرا|تاش',
    ur'سگ|مرغ|خوک': ur'دانی',
    ur'خونین': ur'جگر|چشم|شهر',
    ur'دایم': ur'الخمر',
    ur'دائم': ur'الصوم|الخمر',
    ur'درشت': ur'خو',
    ur'دست': ur'خوش|پاچه|چین|آورد|اندرکاران',
    ur'دم': ur'کلفت',
    ur'دندان|دوره|شهر|بیابان|کوچه|گردا': ur'گرد',
    ur'دودوزه': ur'باز',
    ur'ذوات': ur'الارحام|الاذناب',
    ur'ذوی': ur'القربی|الاوتار|العقول',
    ur'ذی': ur'نفع|صلاحیت|فقار|ربط|قیمت|شعور|علاقه|حیات|فن|روح|عقل|حق',
    ur'چشم|بار|بر|پس|تیر|رو|زیر|غلط': ur'انداز',
    ur'رای|شتاب': ur'دهنده|دهندگان',
    ur'راست': ur'راستکی',
    ur'رحمت': ur'العالمین',
    ur'رسم': ur'الخط',
    ur'رقیق': ur'القلب|الفکر',
    ur'رنگ': ur'وارنگ',
    ur'اندود': ur'کاری',
    ur'سنگ|ریز|دانه|تک|بزرگ|رنگ': ur'دانه',
    ur'رو[یئ]ین|پاد|نرم|سخت': ur'تن',
    ur'روح': ur'افزا',
    ur'ریش': ur'ریش',
    ur'رئیس': ur'الوزراء|الرؤسا',
    ur'تصویب|کار|واژه|اجازه|تکذیب|شب|پایان|اساس|آ[یئ]ین|زندگی|توافق': ur'نامه',
    ur'زنگی': ur'مزاج',
    ur'زوار': ur'دررفته',
    ur'زیست': ur'محیط|بوم',
    ur'سابق|اخیر|فوق|لازم': ur'الذکر',
    ur'سبک': ur'مغز|سنگ|عنان|روح|لقا|سایه|سنگین|دست',
    ur'سبک|سنگین': ur'وزن',
    ur'سربه': ur'مهر',
    ur'سریع': ur'السیر|الانتقال',
    ur'سست': ur'زخم|رگ|ریش|عنصر',
    ur'سنگ': ur'فرش',
    ur'دو|سه|چهار': ur'پایه',
    ur'سیاه': ur'مست|سوخته|چرده',
    ur'سینه': ur'چاک',
    ur'شب': ur'رنگ|پره|اداری|نشین',
    ur'شبانه': ur'روزی',
    ur'شکسته': ur'ناخن|مزاج',
    ur'شکل': ur'گیری|پذیر|دادن',
    ur'شلم': ur'شوربا',
    ur'شوخ': ur'طبع|رو|دیده|چشم',
    ur'شوم|نیک|بلند|بد|خوش': ur'اختر|اقبال',
    ur'شوی': ur'دیده',
    ur'شیرین': ur'عقل|دهن',
    ur'صد': ur'شاخ',
    ur'قتل|بار': ur'عام',
    ur'صف': ur'آوار',
    ur'ضرب': ur'المثل|العجل',
    ur'ضد': ur'اسلام|یهودی|انقلاب|حال|هوایی|زنگ|آفتاب|بارداری|سرمایه‌داری|آب|یخ|اطلاعات|شوره',
    #طبق بندهای    شماره ..
    #'طبق|زمان': ur'بند', 
    ur'طبقه|زمان|درجه|رده|گروه|رتبه|دسته|جمله|تقسیم|بسته|آرماتور|اسکلت|امتیاز|بخش|جدول|جمع|جناح|رنگ|ساز|سایز|سرهم|سطح|شرط|شکم|فاز|فصل|قاب|پارتیشن|چشم|کادر|کمر|گاو|نیم|آب|جیره|خالی|ماست|سیل': ur'بند',
    ur'طوطی|عیال': ur'وار',
    ur'طویل': ur'المدت',
    ur'طبیعت|اسلام|یهودی': ur'ستیز|گریز',
    ur'طی': ur'الارض',
    ur'هنر|عاشق': ur'پیشه',
    ur'عالی': ur'نسب|رتبه',
    ur'عام': ur'المنفعه',
    ur'عدیم': ur'النظیر',
    ur'عقب': ur'گرد|نشینی',
    ur'علی': ur'البدل|الحساب|الخصوص|رغم',
    ur'غلط': ur'غلوط',
    ur'فارغ': ur'الاکناف|التحصیل',
    ur'فراخ': ur'رو|شکم|بال|کام|دیده|سخن|آهنگ|دست|آستین|ابرو|روزی',
    ur'فرخ': ur'لقا|دیم|فال|پی',
    ur'فرمان': ur'روا|بر',
    ur'فرنگی|قدسی': ur'مآب',
    ur'غیر': ur'قابل|متعهد|اخلاقی|شرعی|انسانی|اصولی|مجاز|حضوری|دولتی|نظامی|انتفاعی|منتظره|قانونی|معمولی|ممکن|رسمی|فعال|نفتی|منقول|ارادی|جایز|طبیعی|عادی|عمد|لازم|مسئول|عادلانه|خودی|عاقلانه|کافی',
    ur'وفا|فره|نیاز|جفا|خرد|غیرت|باور|ارزش|نعل|درد|علاقه': ur'مند',
    ur'فرو': ur'نهادن|داشت|گذاشت|مایه|بست|پاشی|پاشیده',
    ur'خارق|فوق': ur'العاده',
    ur'کیلو|سانتی|میلی|دسی|نانو|ولت': ur'متر|آمپر|گرم',
    ur'قاچ': ur'قاچ',
    ur'قایق|کلک|کشتی': ur'ران|سوار',
    ur'قافله': ur'سالار',
    ur'قایم': ur'الزاویه',
    ur'قره': ur'قاطی',
    ur'قریب': ur'الوقوع',
    ur'کاه|قطره|دله|آفتابه': ur'دزد',
    ur'قوی|آتشین': ur'پنجه',
    ur'قیمه': ur'قیمه',
    ur'کاسه': ur'یکی|سیاه|لیس',
    ur'کج': ur'نهاد|خلق|کلاه',
    ur'کوه|صخره|دریا|فضا|صحرا': ur'نورد',
    ur'کلاه': ur'گوشه|گذار',
    ur'کله': ur'معلق|خشک|گنده|خر|شق|پوک',
    ur'زبانه|زمین|ماشین|فرمان|کمان|کنگره|گوشه|دامنه|خانه|پول|مقام|آ[یئ]ینه|عهده|بار': ur'دار',
    ur'مصاحبه|تهیه|تعیین|استفاده|کنترل|تسهیل': ur'شونده|شوندگان|کننده|کنندگان',
    ur'کهن': ur'سال|دیار',
    ur'کینه': ur'توز|ورز',
    ur'گران': ur'مغز|سایه|قدر|رکاب|سرشت|پایه|قیمت|روح|سنگ|جان|سر|فروش',
    ur'فضل': ur'فروش',
    ur'گشاده': ur'رو|دست',
    ur'گل': ur'چهره|ریزان|ریز|باران|آرا|اندام|برگ',
    ur'گلوله': ur'باران',
    ur'لازم': ur'الوصول|الاجراء',
    ur'مشکوک|معلوم|مجهول|فارغ': ur'الحال',
    ur'لت': ur'لت|انبان|انبار',
    ur'لسان': ur'الغیب',
    ur'مالک': ur'الرقاب',
    ur'ماه': ur'طلعت',
    ur'مشغول': ur'الذمه',
    ur'معظم': ur'له|القدر',
    ur'ملی|همجنس|زمینه|آرمان|جهاد|اسلام|بنیاد|چپ|راست|صنعت|طبیعت|برون|درون|شرق|غرب|وجدان|اعتدال|عقل': ur'گرا',
    ur'میرزا': ur'قلمدان|قشمشم|بنویس',
    ur'ناخن': ur'خشک',
    ur'نازک': ur'نی|نارنجی|خیال',
    ur'جهان|نافه': ur'گشا',
    ur'ندید': ur'بدید',
    ur'نظریه|رویا|رؤیا': ur'پرداز',
    ur'نقشه|وزنه|بهره|کلاه': ur'بردار',
    ur'نق': ur'نقو',
    ur'نگون': ur'طشت|بخت',
    ur'نیک': ur'روز|انجام|پی|بخت',
    ur'نیم': ur'ته|بسمل',
    ur'هرکن': ur'پرکن',
    ur'همایون': ur'فال|آثار|بخت',
    ur'همه': ur'کاره|جانبه',
    ur'هیچ': ur'کاره|یک|کس|کدام|کجا',
    ur'هیچ|دید|شبان|سحر': ur'گاه',
    ur'ول': ur'خرج|معطل',
    ur'یکه': ur'شناس|بزن|سوار|تاز|چین|بند|بنداز|زا',
    ur'یک': ur'هوا|هشتم|وقت|وزن|ور|وجب|نیمه|نفر|نفس|لا|گوشه|کم|کله|کلام',
    ur'ابجد': ur'خوان',
    ur'ابر': ur'آلود|قدرت|ابزار',
    ur'ابو': ur'العجب|الکلام|الهول',
    ur'اولو': ur'الالباب|الامر|العزم',
    ur'حسب|صاحب|واجب': ur'الامر',
    ur'گل|آذر|ناهم|هم|گندم': ur'گون',
    ur'آزاد': ur'مرد|وار',
    ur'باز': ur'خرید|خواست|دید|بین',
    ur'بر': ur'هم|آشفتگی|آشفته|پایی',
    ur'بلند': ur'آوازه|پایه',
    ur'آتش': ur'بس|نشان|سوزی|افروز|افکن|افزار',
    ur'پا': ur'برجا|برهنه|بست|پتی',
    ur'پایه|بنیان|بمب': ur'گذار|گذاری',
    ur'پر': ur'ابهام|ابهت|اتلاف|ادا|ادویه|ازدحام|استرس|استقامت|اشک|برخورد|ترانه|تردد|ترشح|تشبیه|تصادف|تعصب|تقلب|تلاش|تملق|شور|هیاهو|بیننده|بار',
    ur'کم': ur'محل|بضاعت|کم',
    ur'پر|کم': ur'نظیر|کار|تعداد|اشتباه|اشکال|اهمیت|تحرک|تحول|ترافیک|تراکم|تقاضا|تکرار|تنش|تنوع|رو|آب',
    ur'تنگا': ur'تنگ',
    ur'تیز': ur'پا|دست|دندان|هوش|بین',
    ur'چادر|تخت|زاغه|شهر|ته|آب|کاخ|پایتخت|یکجا|ییلاق|قشلاق': ur'نشین',
    ur'چهار': ur'شانه',
    ur'فلز|تشابه|ویروس|مکان|طلا|کم|عیب|مسافت|فاصله|جهت|موقعیت|غلط|راه|اشتباه|گنج': ur'یاب',
    ur'دستگیر': ur'شدگان|شده',
    ur'یاد': ur'داشت|دهی',
    ur'یار': ur'کشی',
    ur'ی[اأ]س': ur'آلود',
    ur'حاضر': ur'جواب|یراق',
    ur'خرد': ur'سال',
    ur'دو': ur'برجی|تخمه|سره|قلو|به‌شک',
    ur'ذو': ur'الجلال|العرش|القدر|القوافی|اللسانین|المجد|المکارم|المن|المناقب|المنن|النور|الوجهین|جسدین',
    ur'رنگا': ur'رنگ',
    ur'رو': ur'سفید|سیاه|باز',
    ur'قهوه|نگار|آبدار|گل|کتاب|رود|زور|نوا|سرد': ur'خانه',
    ur'روز': ur'افزون|انه',
    ur'زود': ur'باور',
    ur'شاد': ur'روان|کام|مان|مانه',
    ur'فرا': ur'خور|روی',
    ur'کد': ur'خدا|بانو',
    ur'لا': ur'ابالی|جون|کردار|مذهب|مروت|یتغیر|یتناهی|یزال|یعقل',
    ur'نا': ur'جوانمرد|خودآگاه|نجیب|امید|آزموده|آشنا|آگاه|برابر|تمام'
}
# ----------------------------------------Wrong dictations-----------------------

forReplace = {  # 'میسیسیپی': u'می‌سی‌سی‌پی',
    # 'هاوی': u'حاوی', ممکن است اسم خاص باشد
    # 'سوماً': u'سوم',
    # 'سوما': u'سوم',
    # 'دوماً': u'دوم',
    # 'دوما': u'دوم',
    # 'جانا': u'جانی', باگ در [[جانا رودین]]
    # 'طوسی': u'توسی', خواجه نصیرالدین طوسی را به تبدیل می کرد
    # برپایه http:#www.persianacademy.ir/fa/pishvand.aspx
    # بدل از تنوین
    ur'به شخصه': u'بشخصه',
    ur'به‌شخصه': u'بشخصه',
    ur'به عینه': u'بعینه',
    ur'به‌عینه': u'بعینه',
    ur'احمدی نژاد': u'احمدی‌نژاد',
    ur'جابه جا': u'جابه‌جا',
    ur'جا به جا': u'جابه‌جا',
    ur'جا به‌جا': u'جابه‌جا',
    ur'بی بی سی': u'بی‌بی‌سی',
    ur'اف بی آی': u'اف‌بی‌آی',
    ur'می سی سی پی': u'می‌سی‌سی‌پی',
    ur'ویژه‌گی': u'ویژگی',
    ur'دایره‌المعارف': u'دایرةالمعارف',
    ur'دایره المعارف': u'دایرةالمعارف',
    ur'تأئید': u'تأیید',
    ur'تائید': u'تأیید',
    ur'بقیه‌الله': u'بقیةالله',
    ur'بقیه الله': u'بقیةالله',
    ur'بقیة الله': u'بقیةالله',
    ur'دگمه': u'دکمه',
    ur'وحله': u'وهله',
    ur'نقطه‌نظر': u'دیدگاه',
    ur'ناچاراً': u'به‌ناچار',
    ur'ناچارا': u'به‌ناچار',
    ur'منیت': u'منی',
    ur'منیٔت': u'منی',
    ur'فرآیند': u'فرایند',
    ur'فرآیندها': u'فرایندها',
    ur'کارآیی': u'کارایی',
    ur'ملاحضه': u'ملاحظه',
    ur'ملیون': u'میلیون',
    ur'ملیارد': u'میلیارد',
    ur'مطمعن': u'مطمئن',
    ur'مرهمت': u'مرحمت',
    ur'مرحم': u'مرهم',
    ur'محصوب': u'محسوب',
    ur'مذبور': u'مزبور',
    ur'متعصفانه|متاصفانه': u'متأسفانه',
    ur'متغییر': u'متغیر',
    ur'لشگر': u'لشکر',
    ur'لحجه': u'لهجه',
    ur'گاهاً': u'گاهی',
    ur'گاها': u'گاهی',
    ur'کهکیلویه': u'کهگیلویه',
    ur'قائله': u'غائله',
    ur'فارق‌التحصیل': u'فارغ‌التحصیل',
    ur'علاالدین': u'علاءالدین',
    ur'علم‌شنگه': u'الم‌شنگه',
    ur'غلطاندن': u'غلتاندن',
    ur'ظبط': u'ضبط',
    ur'طنبور': u'تنبور',
    ur'طپش': u'تپش',
    ur'ضمینه': u'زمینه',
    ur'زخامت|ذخامت': u'ضخامت',
    ur'زخیم|ذخیم': u'ضخیم',
    ur'صحفه': u'صفحه',
    ur'سفارشاً': u'سفارشی',
    ur'سفارشا': u'سفارشی',
    ur'سرلشگر': u'سرلشکر',
    ur'سپاسگذار': u'سپاسگزار',
    ur'خبرگذار': u'خبرگزار',
    ur'ساتع': u'ساطع',
    ur'زنده‌گی': u'زندگی',
    ur'زباناً': u'زبانی',
    ur'زبانا': u'زبانی',
    ur'رهبریت': u'رهبری',
    ur'در باره': u'درباره',
    ur'دوئیت': u'دوگانگی',
    ur'داوطلبین': u'داوطلبان',
    ur'خوشنود': u'خشنود',
    ur'خوبیت': u'خوبی',
    ur'خوانواده': u'خانواده',
    ur'خواستگاه': u'خاستگاه',
    ur'خرشید': u'خورشید',
    ur'خردن': u'خوردن',
    ur'خانند': u'خوانند',
    ur'خابیدن': u'خوابیدن',
    ur'حظور': u'حضور',
    ur'حظرت': u'حضرت',
    ur'حدلامکان': u'حتی‌الامکان',
    ur'حاظر': u'حاضر',
    ur'چهارماً': u'چهارم',
    ur'چهارما': u'چهارم',
    ur'چارشنبه': u'چهارشنبه',
    ur'جاناً': u'جانی',
    ur'توجیح': u'توجیه',
    ur'توضیع': u'توزیع',
    ur'تلوزیون': u'تلویزیون',
    ur'تضاهر': u'تظاهر',
    ur'ترجیه': u'ترجیح',
    ur'پنچ': u'پنج',
    ur'پزشگی': u'پزشکی',
    ur'پرفسور': u'پروفسور',
    ur'پاتوغ': u'پاتوق',
    ur'بی‌مهابا': u'بی‌محابا',
    ur'بنیانگزار': u'بنیانگذار',
    ur'بلقور': u'بلغور',
    ur'بلاخره': u'بالاخره',
    ur'برخواستن': u'برخاستن',
    ur'برعلیه': u'علیه',
    ur'برخواست': u'برخاست',
    ur'بدیت': u'بدی',
    ur'باطلاق': u'باتلاق',
    ur'بازرسین': u'بازرسان',
    ur'بارگزار': u'بارگذار',
    ur'باجناق': u'باجناغ',
    ur'باباقوری': u'باباغوری',
    ur'آروق': u'آروغ',
    ur'انظباط': u'انضباط',
    ur'التفاط': u'التفات',
    ur'افضل‌تر': u'بهتر',
    ur'افسنطین': u'افسنتین',
    ur'اعلم‌تر': u'داناتر',
    ur'اطو': u'اتو',
    ur'اطراق': u'اتراق',
    ur'اطاق': u'اتاق',
    ur'اصطرلاب': u'اسطرلاب',
    ur'ارتقاع': u'ارتقا',
    ur'اختاپوث': u'اختاپوس',
    ur'ابولفضل': u'ابوالفضل',
    ur'امپراطور': u'امپراتور',
    ur'آزوقه': u'آذوقه',
    ur'ذکام': u'زکام',
    ur'بگیر و ببند': u'بگیر ببند',
    ur'ساز و کار': u'سازوکار',
    ur'جر و بحث': u'جربحث',
    ur'خوار و بار': u'خواربار',
    ur'احجام': u'حجم‌ها',
    ur'اقشار': u'قشرها',
    ur'لازم به ذکر است': u'لازم است ذکر شود',
    ur'بدلیل': u'به دلیل',
    ur'آن‌را': u'آن را',
    ur'این‌را': u'این را',
    ur'هیات': u'هیئت',
    ur'هیأت': u'هیئت',
    ur'رییسه': u'رئیسه',
    ur'رییس': u'رئیس',
    ur'مساله': u'مسئله',
    ur'مسأله': u'مسئله',
    ur'همین جا': u'همین‌جا',
    ur'همینجا': u'همین‌جا',
    ur'همینطور': u'همین‌طور',
    ur'همین طور': u'همین‌طور',
    ur'همان جا': u'همان‌جا',
    ur'همانجا': u'همان‌جا',
    ur'همان طور': u'همان‌طور',
    ur'همانطور': u'همان‌طور',
    ur'هیچکدام': u'هیچ‌کدام',
    ur'هیچ کدام': u'هیچ‌کدام',
    ur'هیچکس': u'هیچ‌کس',
    ur'هیچ کس': u'هیچ‌کس',
    ur'هیچیک': u'هیچ‌یک',
    ur'هیچ یک': u'هیچ‌یک',
    ur'هم‌دیگر': u'همدیگر',
    ur'آن چه': u'آنچه',
    ur'آن‌چه': u'آنچه',
    ur'چنان چه': u'چنانچه',
    ur'چنانچه': u'چنانچه',
    ur'چنان که': u'چنان‌که',
    ur'چنانکه': u'چنان‌که',
    ur'ئیدروژن': u'هیدروژن',
    ur'بعضن': u'بعضاً',
    ur'غالبن': u'غالباً',
    ur'کاملن': u'کاملاً',
    ur'احتمالن': u'احتمالاً',
    ur'اصلن': u'اصلاً',
    ur'اشتباهن': u'اشتباهاً',
    ur'منشاء': u'منشأ',
    ur'مبداء': u'مبدأ',
}

persianGlyphs = {  # these two are for visually available ZWNJ #visualZwnj
    ur'\u200cه': u'ﻫ',
    ur'ی\u200c': u'ﻰﻲ',
    ur'أ': u'ﺄﺃﺃ',
    ur'آ': u'ﺁﺁﺂ',
    ur'إ': u'ﺇﺈﺇ',
    ur'\u0627': u'ﺍﺎ',
    ur'ب': u'ﺏﺐﺑﺒ',
    ur'پ': u'ﭖﭗﭘﭙ',
    ur'ت': u'ﺕﺖﺗﺘ',
    ur'ث': u'ﺙﺚﺛﺜ',
    ur'ج': u'ﺝﺞﺟﺠ',
    ur'چ': u'ﭺﭻﭼﭽ',
    ur'ح': u'ﺡﺢﺣﺤ',
    ur'خ': u'ﺥﺦﺧﺨ',
    ur'د': u'ﺩﺪ',
    ur'ذ': u'ﺫﺬ',
    ur'ر': u'ﺭﺮ',
    ur'ز': u'ﺯﺰ',
    ur'ژ': u'ﮊﮋ',
    ur'س': u'ﺱﺲﺳﺴ',
    ur'ش': u'ﺵﺶﺷﺸ',
    ur'ص': u'ﺹﺺﺻﺼ',
    ur'ض': u'ﺽﺾﺿﻀ',
    ur'ط': u'ﻁﻂﻃﻄ',
    ur'ظ': u'ﻅﻆﻇﻈ',
    ur'ع': u'ﻉﻊﻋﻌ',
    ur'غ': u'ﻍﻎﻏﻐ',
    ur'ف': u'ﻑﻒﻓﻔ',
    ur'ق': u'ﻕﻖﻗﻘ',
    ur'ک': u'ﮎﮏﮐﮑﻙﻚﻛﻜ',
    ur'گ': u'ﮒﮓﮔﮕ',
    ur'ل': u'ﻝﻞﻟﻠ',
    ur'م': u'ﻡﻢﻣﻤ',
    ur'ن': u'ﻥﻦﻧﻨ',
    ur'ه': u'ﻩﻪﻫﻬ',
    ur'هٔ': u'ﮤﮥ',
    ur'\u0648': u'ﻭﻮ',
    ur'ؤ': u'ﺅﺅﺆ',
    ur'ی': u'ﯼﯽﯾﯿﻯﻰﻱﻲﻳﻴ',
    ur'ئ': u'ﺉﺊﺋﺌ',
    ur'لا': u'ﻻﻼ',
    ur'لإ': u'ﻹﻺ',
    ur'لأ': u'ﻸﻷ',
    ur'لآ': u'ﻵﻶ',
}

def my_replace(match, word1, word2):
    match = match.group()
    return match.replace(word1, word2)

def quotation(text):
    # این تابع زمانی گیومه را به فارسی تیدیل می‌کند که در پاراگراف مورد نظر تعداد گیومهٔ لاتین زوج باشد.

    lines = text.split(ur'\n')
    result = []
    for i in range(0,len(lines)):
        line = lines[i]

        # رفع مشکل استفاده از ـً به جای گیومه لاتین در متن فارسی

        line = re.sub(ur'ا\"([ ]*[' + persianCharacters + ur'])', u'اً\\1',line)

        # ”“ تبدیل

        line = re.sub(ur'(^|[' + persianCharacters+ ur'\:>،»؛\s\n\}\]\.]+)“((?:\[\[|).*?['+ persianCharacters+ ur'\n]+?(?:\]\]|\.|\<|\:|))”(['+ persianCharacters+ ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)
        # وارونه ”“ تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)"((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|))"(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)

        # وارونه ”“ تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)”((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|))“(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)

        # ‘’ تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)‘((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|))’(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)

        # وارونه ‘’ تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)’((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|))‘(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)

        # ‚’ تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)‚((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|\{|\[|))’(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)

        # „” تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)„((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|))”(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)

        # << >> تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)\<\<((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|))\>\>(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)

        # (()) تبدیل

        line = re.sub(ur'(^|[' + persianCharacters
                            + ur'\:>،»؛\s\n\}\]\.]+)\(\(((?:\[\[|).*?['
                            + persianCharacters
                            + ur'\n]+?(?:\]\]|\.|\<|\:|))\)\)(['
                            + persianCharacters
                            + ur'،«؛\s\n\.\[\{]|$)', u'\\1«\\2»\\3',line)
        result.append(line)
    return ur'\n'.join(result)

def dictationReplace(x,y,extensions,text):
    Regex=ur'(^|[^' + persianCharacters + ur'])(\s|\u200c|_|)(' + x + ur')(\s|_)('+ y + ur')(\s|\u200c|_|)(' + extensions + ur')(\n|[^' + persianCharacters + ur'])'
    text = re.sub(Regex,u'\\1\\2\\3\u200c\\5\\6\\7\\8',text)
    return text

def complex_replace(txt, pat, w1, w2):
    def function(s):
        return s.group(1)+s.group(2).replace(w1, w2,1)+s.group(3)+s.group(4)
    txt=re.sub(re.compile(pat),function,txt)
    return txt

def dictation(text):
    for i in complexes:
        if complexes.has_key(i):
            text = dictationReplace(i, complexes[i],
                                    ur'ی|یی|ها|های|هایی|هایم|هایت|هایش|هایمان|هایتان|هایشان|', text)

    # for last name

    text = dictationReplace(personNames,
                            ur'ی|یی|زاده|نیا|گان|فر|نژاد|یان|ی\u200cها|یها'
                            , ur'ی|', text)

    # for 'آباد's

    text = dictationReplace(personNames + ur'|' + addToAbad, ur'آباد',
                            ur'زاده|نیا|پور|گان|فر|نژاد|ی|یان|ها|های|یی|هایی|ی\u200cها|یها|'
                            , text)

    # for first names

    for i in firstNameComplex:
        if firstNameComplex.has_key(i):
            text = re.sub(ur'(^|[^' + persianCharacters
                                + ur']|\s|_)(' + i + ur')(\s|_)('
                                + firstNameComplex[i]
                                + ur')(\s|_)($|[^' + persianCharacters
                                + ur']|[' + persianCharacters + ur'])',
                                u'\\1\\2\u200c\\4\\5\\6',text)

    # for colors

    text = dictationReplace(colorsNames, ur'فام|گون', ur'زاده|نیا|پور|گان|فر|نژاد|ی|یی|ها|های|هایی|ی\u200cها|یها|هایم|هایت|هایش|هایمان|هایتان|هایشان|', text)

    # for numbers

    text = dictationReplace(persianNumbers, ur'گانه|ماهه', ur'زاده|نیا|پور|گان|فر|نژاد|ی|یی|ها|های|هایی|هایم|هایت|هایش|هایمان|هایتان|هایشان|', text)

    # wrong dictation

    for i in forReplace:
        if forReplace.has_key(i):
            text = re.sub(ur'(^|[^' + persianCharacters
                                + ur'])(\s|\u200c|_|)(' + i
                                + ur')(\s|\u200c|_|)($|[^'
                                + persianCharacters + ur'])', u'\\1\\2'
                                + forReplace[i] + u'\\4\\5',text)

    # کلماتی که آ دارند

    text = complex_replace(text, ur"(^|\s|_|«|»|\[|\(|\<|\>|\')("+ wordsWithA+ ur")(ی|ئی|یی|ٔ|)( |«|»|\.|،|_|\]|\s|\:|\)|\<|\>|؟|\'|\!|$)", u'\u0627', ur'آ')

    # بن مضارع که آ دارند

    text = complex_replace(text,
                           ur"(^|\u200c|\s|_|«|»|\[|\(|\<|\>|\')("
                           + PresentVerbsWithA
                           + ur")(م|ی|د|یم|ید|ند)( |«|»|\.|،|_|\s|\]|\:|\)|\<|\>|؟|\!|\'|$)"
                           , u'\u0627', ur'آ')

    # بن ماضی که آ دارند

    text = complex_replace(text,
                           ur"(^|\u200c|\s|_|«|»|\[|\(|\<|\>|\')("
                           + PastVerbsWithA
                           + ur")(م|ی|د|یم|ید|ند)( |«|»|\.|،|_|\s|\]|\:|\)|\<|\>|؟|\!|\'|$)"
                           , u'\u0627', ur'آ')

    # همزه ضم

    text = complex_replace(text, ur"(^|\s|_|«|»|\[|\(|\<|\>|\')("
                           + HamzehZam
                           + ur")(‌ها|ها|ین|ان|ی|ئی|یی|ٔ|)( |«|»|\.|،|_|\s|\]|\:|\)|\<|\>|؟|\!|\'|$)"
                           , u'\u0648', ur'ؤ')

    # همزه نصب

    text = complex_replace(text, ur"(^|\s|_|«|»|\[|\(|\<|\>|\')("
                           + HamzehNasb
                           + ur")(ی|ئی|یی|ٔ|)( |«|»|\.|،|_|\s|\]|\:|\)|\<|\>|؟|\!|\'|$)"
                           , u'\u0627', ur'أ')

    # همزه وسط کلمه

    for i in HamzehAtInside:
        if HamzehAtInside.has_key(i):
            text = re.sub(ur"(^|\s|_|«|»|\[|\(|\<|\>|\')(" + i
                                + ur')(| )(' + HamzehAtInside[i]
                                + ur")(?= |«|»|\.|،|_|\s|\]|\:|\)|\<|\>|؟|\!|\'|$)"
                                , u'\\1\\2ء\\4',text)  # در مورد افزودن یا حذف همزهٔ پایانی اجماعی وجود ندارد.

            # الف مقصوره
            text = re.sub(ur"(^|\s|_|«|»|\[|\(|\<|\>|\')(" + HamzehAtEnd + ur")(?= |«|»|\.|،|_|\s|\]|\:|\)|\<|\>|؟|\!|\'|$)",u'\\1\\2ء',text)

            text = complex_replace(text,
                                   ur"(^|\s|_|«|»|\[|\(|\<|\>|\')("
                                   + AlefMaghsooreh
                                   + ur")(| )( |«|»|\.|،|_|\s|\]|\:|\)|\<|\>|؟|\!|\'|$)"
                                   , u'\u0627', ur'ی')

            # صفت+تر

            text = re.sub(ur"(^|\s|_|«|»|\]|\[|\(|\<|\>|\')("
                                + adjective
                                + ur")( |_)تر(?= |«|»|\.|\[|\]|،|_|\s|\:|\)|\<|\>|؟|\!|\'|$)"
                                , u'\\1\\2\u200cتر',text)

            # اسامی رنگ‌ها (به‌عنوان صفت)+تر

            text = re.sub(ur"(^|\s|_|«|»|\]|\[|\(|\<|\>|\')("
                                + colorsNames
                                + ur")( |_)تر(?= |«|»|\.|\[|\]|،|_|\s|\:|\)|\<|\>|؟|\!|\'|$)"
                                , u'\\1\\2\u200cتر',text)

            text = re.sub(ur"به دست\u200cآورد", u'به دست آورد',text)  # Solving a bug!
    def function(s):
        return s.group(1)+s.group(2)[:-1]+u'اً'+s.group(3)
    regex=ur"(^|[؛\s\n\.،«»\'\"\<\>؟])(" + needsNasb + ur')[' + NASB + ZAMM + ur']?([؛؟\s\n\.،«»\'\"\<\>]|$)'
    text=re.sub(regex,function,text, re.UNICODE)
    return text

def normalizeZwnj(text):
    text = re.sub(ur"\u200c{2,}", ur"\u200c",text)

    # Clean ZWNJs after characters that don't conncet to the next letter

    text = \
        re.sub(ur"([۰-۹0-9إأةؤورزژاآدذ،؛,\:«»\\/@#$٪×\*\(\)ـ\-=\|ء])\u200c"
                     , u'\\1',text)

    # Clean ZWNJs before and after English characters

    text = re.sub(ur"\u200c([\w])", u'\\1',text)
    text = re.sub(ur"([\w])\u200c", u'\\1',text)

    # Clean ZWNJs before and after Persian characters

    text = re.sub(ur'\u200c([' + vowels + arabicIndicDigits
                        + persianDigits + hamza + '])', u'\\1',text)
    text = re.sub(ur'([' + arabicIndicDigits + '])\u200c', u'\\1',text)
    text = re.sub(ur"([\w])\u200c", u'\\1',text)

    # Clean ZWNJs after and before punctuation

    text = re.sub(ur"\u200c([ء\n\s\[\]\.،«»\:\(\)\؛\؟\?\;\$\!\@\-\=\+\\|])", u'\\1',text)
    text = re.sub(ur"([\n\s\[\.،«»\:\(\)\؛\؟\?\;\$\!\@\-\=\+\\|])\u200c", u'\\1',text)

    # Clean ZWNJs before brakets which have sapce after\before them

    text = re.sub(ur"\u200c(\][\s\n])", u'\\1',text)
    text = re.sub(ur"([\n\s]\[)\u200c", u'\\1',text)
    return text

def toStandardPersianCharacters(text):
    for i in persianGlyphs:
        text = re.sub(ur'[' + persianGlyphs[i] + ur']', i,text)
    text = normalizeZwnj(text)
    text = text.replace(ur"ك", ur'ک')  # Arabic
    text = text.replace(ur"ڪ", ur'ک')  # Urdu
    text = text.replace(ur"ﻙ", ur'ک')  # Pushtu
    text = text.replace(ur"ﻚ", ur'ک')  # Uyghur
    text = text.replace(ur"ي", ur'ی')  # Arabic
    text = text.replace(ur"ى", ur'ی')  # Urdu
    text = text.replace(ur"ے", ur'ی')  # Urdu
    text = text.replace(ur"ۍ", ur'ی')  # Pushtu
    text = text.replace(ur"ې", ur'ی')  # Uyghur
    text = text.replace(ur"ہ", ur'ه')  # Convert &#x06C1; to &#x0647; ہہہہ to ههه
    text = re.sub(ur"ە", u'ه\u200c',text)  # Kurdish
    text = text.replace(ur"ھ", ur'ه')  # Kurdish
    return text

def applyOrthography(text):
    text = text.replace(ur"\r", ur'')

    # تمیزکاری autoFormatter.js

    #text = re.sub(ur"[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x9F\uFEFF]+", u'',text)
    #text = re.sub(ur"[ \xA0\xAD\u1680\u180E\u2000-\u200D\u2028\u2029\u202F\u205F\u2060\u3000]+\n", u'\n',text)

    # تبدیل تب و فاصله نشکن اول خط به هیچ چون مدیاویکی آن را در نظر نمی‌گیرد

    #text = re.sub(ur"\n[\t\u00A0]+", u'\n',text)

    # تبدیل انواع فاصله‌ها به فاصله ساده

    text = re.sub(ur"[\u0020\u0085\u00A0\u180E\u2000-\u200A\u202F\u205F\u3000]", u' ',text)
    text = re.sub(ur"[\u0085]", u'',text)

    # http:#kb.mozillazine.org/Network.IDN.blacklist_chars

    text = re.sub(ur"[\u01C3\uFE15]", u'!',text)
    text = re.sub(ur"[\u02D0\u0589\u05C3\uA789]", u': ',text)
    text = re.sub(ur"[\u0338\u2044\u2215\u2571\u29F8\u3033\uFF0F]", u'/',text)
    text = re.sub(ur"[\u05F4]", u'"',text)
    text = re.sub(ur"[\u06D4\u0701\uFF0E\uFF61]", u'.',text)
    text = re.sub(ur"\u3014", u'(',text)
    text = re.sub(ur"\u3015", u')',text)

    # جایگزینی ۀ غیراستاندار+حرف بعدی بدون فاصله به ه+همزه+فاصله

    text = re.sub(ur"ۀ(?![\s\n])", u'هٔ ',text)

    # Replace ه followed by (space|ZWNJ|lrm) follow by ی with هٔ

    text = re.sub(ur"ه[\u200c\u200e\s]+ی([\s\n])", u'هٔ\\1',text)

    # Replace ه followed by (space|ZWNJ|lrm|nothing) follow by ء or with هٔ

    text = re.sub(ur"ه[\u200c\u200e\s]*[ءٔ]([\s\n])", u'هٔ\\1',text)

    # Replace هٓ or single-character ۀ with the standard هٔ

    text = re.sub(ur"(ۀ|هٓ)", u'هٔ',text)

    # Replace ه followed by ئ or ی, and then by ی, with ه\u200cای, example: خانهئی becomes خانه\u200cای

    text = re.sub(ur"ه\u200c[ئی]ی", u'ه\u200cای',text)

    # def for removing incorrect ZWNJs

    text = re.sub(ur"([\u200c\u200e])([\s\n])", u'\\2',text)
    text = re.sub(ur"([\s\n])([\u200c\u200e])", u'\\1',text)

    # فاصلهٔ پیش از واکه\u200cهای کوتاه اشتباه است و برای جلوگیر از به هم چسبیدن کلمات فاصله و واکه جابجا باید گردند.

    text = re.sub(ur'([' + persianCharacters + vowels + hamza+ ur'])(\s)([' + vowels + hamza + ur'])',u'\\1\\3\\2',text)

    # واکه\u200cهای کوتاه پشت سرهم نمی\u200cآیند و یک حرف باید بینشان فاصله باشد

    text = re.sub(ur'([' + vowels + hamza + ur']){2,}', u'\\1',text)
    text = re.sub(ur"ئء", ur'یء',text)  # two hamzes after each other
    text = re.sub(ur"أء", ur'اء',text)  # two hamzes after each other
    text = re.sub(ur"ؤء", ur'ؤ',text)  # two hamzes after each other

    # .replace(ur"وء", ur'ؤ')#bug on  سوء

    text = re.sub(ur"سؤ ?استفاده", ur'سوءاستفاده',text)  # bug on سوءاستفاده و سوء

    # افزودن همزه

    text = re.sub(ur"درباره\s(ام|ات|اش|مان|تان|شان|ای)(\s|$)",u'درباره‌\\1\\2',text)  # i برای جلوگیری از باگ احتمالی برای افزودن همزه به درباره
    text = re.sub(ur"درباره\s", ur'دربارهٔ ',text)
    text = re.sub(ur'صفحه(\s|)([' + persianDigits + ']+)(\n|\.|\,|\||\<)', u'صفحهٔ \\2\\3',text)  # [[Special:PermaLink/15326391#افزودن همزه]]
    return text

def complexVerbsApplyZwnj(text):
    for x in persianComplexPastVerbs:
        y = persianComplexPastVerbs[x]
        text = re.sub(ur'(^|[^' + persianCharacters + ur'])(' + x
                            + ur') ?(می|نمی|)( |\u200c|)(ن|)(' + y
                            + ur')(م|ی|یم|ید|ند|ه|ن|)($|[^'
                            + persianCharacters + ur'])',
                            u'\\1\\2\u200c\\3\u200c\\5\\6\\7\\8',text)

    for x in persianComplexPresentVerbs:
        y = persianComplexPresentVerbs[x]
        text = re.sub(ur'(^|[^' + persianCharacters + ur'])(' + x
                            + ur') ?(می|نمی|)( |\u200c|)(ن|)(' + y
                            + ur')(م|ی|د|یم|ید|ند|ن)($|[^'
                            + persianCharacters + ur'])',
                            u'\\1\\2\u200c\\3\u200c\\5\\6\\7\\8',text)
    return text

def applyZwnj(text):
    text = re.sub(ur'(^|[^' + persianCharacters + ur'])(می|نمی) ?'
                        + persianPastVerbs + ur'(م|ی|یم|ید|ند|ه|)($|[^'
                        + persianCharacters + u'])', u'\\1\\2\u200c\\3\\4\\5',text
                        )
    text = re.sub(ur'(^|[^' + persianCharacters + ur'])(می|نمی) ?'
                        + persianPresentVerbs
                        + ur'(م|ی|د|یم|ید|ند)($|[^' + persianCharacters
                        + ur'])', u'\\1\\2\u200c\\3\\4\\5',text)

    # ماضی نقلی
    text = re.sub(ur'(^|[^' + persianCharacters + ur'])(ن|)' + persianPastVerbs +ur'ه (ام|ای|ایم|اید|اند|است)($|[^' + persianCharacters + ur'])',u'$1$2$3ه\u200c$4$5',text)

    # بن فعل مضارع «دان» جدا آمد چون پسوند «ی» با عبارت «میدانی» تداخل داشت

    text = re.sub(ur'(^|[^' + persianCharacters
                        + ur'])(می|نمی) ?(دان)(م|د|یم|ید|ند)($|[^'
                        + persianCharacters + ur'])', u'\\1\\2\u200c\\3\\4\\5',text
                        )

    # ای «توان» ناقلا!

    text = re.sub(ur"(\s)(می|نمی) ?توان", u'\\1\\2\u200cتوان',text)

    # چسباندن تمام «ها»ها با فاصلهٔ مجازی

    text = re.sub(ur"\sها([\]\.،\:»\)\s]|\'{2,3}|\={2,})",u'\u200cها\\1',text)
    text = re.sub(ur"\sها(ی|یی|یم|یت|یش|مان|تان|شان)([\]\.،\:»\)\s])", u'\u200cها\\1\\2',text)
    text = re.sub(ur"هها", u'ه‌ها',text)

    # چسباندن تمام «ترین»ها با فاصلهٔ مجازی

    text = re.sub(ur"\sترین([\]\.،\:»\)\s]|\'{2,3}|\={2,})",u'\u200cترین\\1',text)
    # چسباندن تمام «تبار»ها با فاصلهٔ مجازی
    text = re.sub(ur'([' + persianCharacters + ur']ی) تبار([^' + persianCharacters + ur'])',u'\\1\u200cتبار\\2',text)
    # چسباندن تمام «شناس»ها با فاصلهٔ مجازی
    text = re.sub(ur'([' + persianCharacters + ur']ی) شناس([^' + persianCharacters + ur'])',u'\\1\u200cشناس\\2',text)

    # برای حذف علامت ستاره اضافی قبل از عنوان ها

    text = re.sub(ur"\n\*\s*(\=+.+?\=+\n)", u'\n\\1',text)

    # عضو علامت های نقل قول تکی از عنوان ها

    text = re.sub(ur"(\n=+)(.*?)(?:'+)(.*?)(?:'+)(.*?)(=+\n)", u'\\1\\2\\3\\4\\5',text)

    # اول و آخر هم خط اگر فاصلهٔ مجازی باشد، حذف شود

    text = re.sub(ur"(^\u200c|\u200c$)", u'',text)

    # شناسه ها
    # توجه: «است» تعدماً از شناسه ها حذف شده چون به عنوان فعل مستقل هم کاربرد دارد و در آن موارد باید جدا نوشته شود
    # مثال: «این یک خانه است» که است در آن باید از خانه جدا نوشته شود

    text = re.sub(ur'ه\s+(ام|ای|ایم|اید|اند)($|[^' + persianCharacters + ur'\u200c])', u'ه\u200c\\1\\2',text)

    # موارد جزئی دیگر و بی ربط به فاصلهٔ مجازی، باید منتقل شود

    text = re.sub(ur"ا\sً", u'اً',text)

    # رفع اشکال که\u200cای

    text = re.sub(ur" که\u200cای ", u' که ای ',text)

    # رفع اشکال میستری (Mystery)

    text = re.sub(ur"می\u200cستری", u'میستری',text)
    text = re.sub(ur'می\u200cگوی($|[^' + persianCharacters
                        + ur'\u200c])', u'میگوی\\1',text)  # for میگوی دریایی
    text = re.sub(ur'می\u200cدوی($|[^' + persianCharacters
                        + ur'\u200c])', u'میدوی\\1',text)  # for [[میدوی (ابهام‌زدایی)]]
    return text

def punctuation(text):
    text = re.sub(ur"\r", u'',text)
    # / سجاوندی غیرفارسی

    text = re.sub(ur"ː", u': ',text)  # Replace incorrect : character

    # استفاده از ؟ فارسی

    text = re.sub(ur'([' + persianCharacters + ur'])[ ]*[?]',u'\\1؟',text)

    # استفاده از ; فارسی

    text = re.sub(ur'([' + persianCharacters + ur'])[ ]*[;]',u'\\1؛ ',text)

    # استفاده از ، فارسی

    text = re.sub(ur'([' + persianCharacters + ur'])(\]|»|\)|) *, *', u'\\1\\2، ',text)

    # حذف دو فاصله بعد از سجاوندی

    text = re.sub(ur"(،|؛|؟|\.|:|,|\!)  ", u'\\1 ',text)


    # افزودن یا حذف فاصله
    # حذف فاصله‌های تکراری میان واژه‌ها، به جز بین نام پارامتر و علامت مساوی

    text = re.sub(ur"(. ) +(?=[^= ])", u'\\1',text)

    # فاصله بعد از سجاوندی به جز ! به دلیل (<!-- و !! در بالای جدول‌ها)

    text = re.sub(ur"([،\.\؛\؟»\!;,])([^\s\.\(\)«»\"\[\]<>\d\w\{\}\|۰۱۲۳۴۵۶۷۸۹\'])", u'\\1 \\2',text)

    # افزودن فاصله به بعد از سجاوندی

    text = re.sub(ur'([' + persianCharacters + ur']+|\]|\)|»)([؟،؛\!\.])(['+ persianCharacters + persianDigits + ur']+|\[|\(|«)', u'\\1\\2 \\3',text)

    # حذف فاصله بعد از گیومه، پرانتز، براکت باز

    text = re.sub(ur"([\(«\[])\s", u'\\1',text)

    # حذف فاصله قبل از گیومه، پرانتز، براکت بسته

    text = re.sub(ur"\s([\)»\]])", u'\\1',text)

    # افزودن فاصله قبل از گیومه باز

    text = re.sub(ur"([^ \(\[\|\r\n>'])(«)", u'\\1 \\2',text)
    text = re.sub(ur" +\( +", u' (',text)
    text = re.sub(ur'([' + persianCharacters
                        + ur']|\]|») *\( *(?=[' + persianCharacters
                        + ur'])(?!ها\)|ان\))', u'\\1 (',text)
    text = re.sub(ur'([' + persianCharacters + ur']) *\) *(?=['
                        + persianCharacters + ur']|\[|«)', u'\\1) ',text)

    # Convert , to ، if there are Persian characters on both sides of it

    text = re.sub(ur'([' + persianCharacters + ur']), ?(?=['
                        + persianCharacters + ur'])', u'\\1\\2، ',text)

    # بعد از نقطه‌ویرگول فارسی علامتی قرار نمی‌گیرد

    text = re.sub(ur"(؛)(([\s]+)?[\.،؛:!؟\-…])", u'\\1',text)

    # در انتهای پاراگراف نقطه‌ویرگول فارسی نمی‌آید

    text = re.sub(ur"(؛)(\s|)\n", u'.\n',text)

    # سجاوندی در ابتدای علامت باز قرار نمی‌گیرد

    text = re.sub(ur"([\(«])[\s]([؛\.،])", ur'\\1',text)

    # ویرگول فارسی
    # بعد از ویرگول فارسی این علامت‌ها قرار نمی‌گیرد

    text = re.sub(ur"(،)([\s]+)?([،؛!؟\-][\.،؛!؟\-]*|\.(?!\.))",
                        u'\\1',text)

    # نقطه
    # باید سه نقطه باشد

    text = re.sub(ur'([' + persianCharacters + ur'])( *)(\.{3,})'
                        , u'\\1\\2…',text)
    text = re.sub(ur" \.\.\. ", ur' … ',text)

    # بعد از نقطه این علایم نمی‌آیند

    text = re.sub(ur'([' + persianCharacters
                        + ur'])\.( *[،؛:!؟\?]+)', u'\\1.',text)

    # سجاوندی در ابتدای پرانتز و گیومه باز قرار نمی‌گیرد

    text = re.sub(ur'(\(|«)[\.،؛](\s|)([' + persianCharacters
                        + ur'])', u'\\1\\3',text)

    # سجاوندی در داخل پرانتز

    text = re.sub(ur'([' + persianCharacters
                        + ur'])(\s|)[\.،؛](\s|)(\))', u'\\1\\2\\3\\4',text)

    # در صورت وابستگی معنی جملات بهتر است نقطه‌ویرگول فارسی قرار گیرد

    text = re.sub(ur'([' + persianCharacters
                        + ur'])(\s|)(\.)(\s|)(ولی|که\s|و\s|بنابراین|لذا)'
                        , u'\\1؛ \\5',text)

    # / Question & exclamation mark
    # علامت تعجب تکراری به دلیل وجود !! در عنوان جدول‌های مدیاویکی نباید اصلاح شود.
    # تكرار علامت سوال فارسی

    text = re.sub(ur"(؟(\s|)){2,}", u'؟',text)

    # علامت‌گذاری نادرست

    text = text.replace(ur'؟ !', ur'؟!').replace(ur'! ؟', u'!؟')

    # Remove space preceding punctuation, except for ellipses

    text = re.sub(ur"([^ \.]) +([؟،\:؛!\.])(\s[^ \.]|<|$)",
                        u'\\1\\2\\3',text)
    return text

def run (text):
    text = normalizeZwnj (text)
    text = quotation (text)
    text = dictation (text)
    text = toStandardPersianCharacters (text)
    text = applyOrthography (text)
    text = complexVerbsApplyZwnj (text)
    text = applyZwnj (text)
    text = punctuation (text)
    text = normalizeZwnj (text)
    return text

def Open_pptx(file_path):
    #for opening pptx you should install libraries .run these commands 
    # pip install pypiwin32
    # now you can use pptx
    silide_num=0
    Text_num=0
    txt_edited_num=0
    from time import gmtime, strftime
    import win32com.client, sys
    Application = win32com.client.Dispatch("PowerPoint.Application")
    Application.Visible = True
    Presentation = Application.Presentations.open(file_path,False,True,False)
    print '+++++++++++++++++++++++++++++++++++++'
    print 'Starting at '+strftime("%Y-%m-%d %H:%M:%S", gmtime())
    for Slide in Presentation.Slides:
        silide_num+=1
        print 'Silde '+str(silide_num)
        for Shape in Slide.Shapes:
            try:
                text=Shape.TextFrame.TextRange.Text
            except:
                continue
            Text_num+=1
            text=Shape.TextFrame.TextRange.Text
            if re.sub(u'['+persianCharacters+u']',u'',text)!=text:
                my_result=run (text)
                if text!=my_result:
                    txt_edited_num+=1
                    Shape.TextFrame.TextRange.Text=my_result

    print '********************'
    print str(silide_num)+' slides was checked'
    print str(Text_num)+' texts was checked'
    print str(txt_edited_num)+' texts was edited'
    Presentation.SaveAs(file_path.replace(u'.pptx',u'-new_edition.pptx'))
    Application.Quit()
    print 'File '+ file_path.replace(u'.pptx',u'-new_edition.pptx')+' created successfully!'
    print '********************'
    print 'Finished at '+strftime("%Y-%m-%d %H:%M:%S", gmtime())
    print '+++++++++++++++++++++++++++++++++++++'

def test(num,txt,txt2):
    result=run (txt)
    if result!=txt2:
        print u'Case >' + txt
        print u'Expected >' + txt2
        print u'Result >'+ result
        print u'---------'
    else:
        print u'Test '+str(num)+u' > '+txt2+u' is OK!'

def do_test():
    test (1,u'من نرم افزار را می گزاریم . متن',u'من نرم‌افزار را می‌گزاریم. متن')
    test (2,u'متن '+ u'می انباشتم'+u' متن',u'متن '+ u'می‌انباشتم'+u' متن')
    test (3,u'متن '+ u'می چسبم'+u' متن',u'متن '+ u'می‌چسبم'+u' متن')
    test (4,u'متن '+ u'باز آفریدم'+u' متن',u'متن '+ u'بازآفریدم'+u' متن')
    test (5,u'متن '+ u'باز آفرینم'+u' متن',u'متن '+ u'بازآفرینم'+u' متن')
    test (6,u'متن '+ u'محمد زاده'+u' متن',u'متن '+ u'محمدزاده'+u' متن')
    test (7,u'متن '+ u'هجوامیز'+u' متن',u'متن '+ u'هجوآمیز'+u' متن')
    test (8,u'متن '+ u'ارام'+u' متن',u'متن '+ u'آرام'+u' متن')
    test (9,u'متن '+ u'می ارامم'+u' متن',u'متن '+ u'می‌آرامم'+u' متن')
    test (10,u'متن '+ u'می اشامید'+u' متن',u'متن '+ u'می‌آشامید'+u' متن')
    test (11,u'متن '+ u'اتفاقا'+u' متن',u'متن '+ u'اتفاقاً'+u' متن')
    test (12,u'متن '+ u'مودب'+u' متن',u'متن '+ u'مؤدب'+u' متن')
    test (13,u'متن '+ u'تالیف'+u' متن',u'متن '+ u'تألیف'+u' متن')
    test (14,u'متن '+ u'استثنا'+u' متن',u'متن '+ u'استثناء'+u' متن')
    test (15,u'متن '+ u'سواستفاده'+u' متن',u'متن '+ u'سوءاستفاده'+u' متن')
    test (16,u'متن '+ u'حتا'+u' متن',u'متن '+ u'حتی'+u' متن')
    test (17,u'متن '+ u'زرد فام'+u' متن',u'متن '+ u'زردفام'+u' متن')
    test (18,u'متن '+ u'دو گانه'+u' متن',u'متن '+ u'دوگانه'+u' متن')
    test (19,u'متن '+ u'عیش آباد'+u' متن',u'متن '+ u'عیش‌آباد'+u' متن')
    test (20,u'متن '+ u'ویکی پدیا'+u' متن',u'متن '+ u'ویکی‌پدیا'+u' متن')
    test (21,u'متن '+ u'ﭖﭗﭘﭙ'+u' متن',u'متن '+ u'پپپپ'+u' متن')
    test (22,u'متن '+ u'علی "گفت" من'+u' متن',u'متن '+ u'علی «گفت» من'+u' متن')
    test (23,u'متن '+ u'علی <<گفت>> من'+u' متن',u'متن '+ u'علی «گفت» من'+u' متن')
    test (24,u'متن '+ u'حمید رضا'+u' متن',u'متن '+ u'حمیدرضا'+u' متن')
    test (25,u'متن '+ u'بزرگ تر'+u' متن',u'متن '+ u'بزرگ‌تر'+u' متن')
    test (26,u'متن '+ u'کوچک ترین'+u' متن',u'متن '+ u'کوچک‌ترین'+u' متن')
    test (27,u'متن '+ u'کتاب ها'+u' متن',u'متن '+ u'کتاب‌ها'+u' متن')
    test (28,u'متن '+ u'نیم‌‌‌فاصله اضافی'+u' متن',u'متن '+ u'نیم‌فاصله اضافی'+u' متن')
    test (29,u'متن '+ u'بعد از ر‌فاصله'+u' متن',u'متن '+ u'بعد از رفاصله'+u' متن')
    test (30,u'متن '+ u'A‌B فاصله مجازی'+u' متن',u'متن '+ u'AB فاصله مجازی'+u' متن')
    test (31,u'متن '+ u'ك عربی'+u' متن',u'متن '+ u'ک عربی'+u' متن')
    test (32,u'متن '+ u'ي عربی'+u' متن',u'متن '+ u'ی عربی'+u' متن')
    test (33,u'متن '+ u'ۀ غیر استاندارد'+u' متن',u'متن '+ u'هٔ غیر استاندارد'+u' متن')
    test (34,u'متن '+ u'متن . نقطه'+u' متن',u'متن '+ u'متن. نقطه'+u' متن')

# This tool edits the powerpoint file
file_path=u'C:/01.pptx'
Open_pptx(file_path)


